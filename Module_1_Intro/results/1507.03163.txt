1507.03163v3 [math.CO] 18 May 2016

arXiv

Maps, immersions and permutations

Aix Marseille Université, Université de Toulon, CNRS, CPT, UMR 73382, 13288 Marseille, France

Robert Coquereaux

Centre de Physique Théorique (CPT)
and

Jean-Bernard Zuber

Sorbonne Universités, UPMC Univ Paris 06, UMR 7589, LPTHE, F-75005, Paris, France
& CNRS, UMR 7589, LPTHE, F-75005, Paris, France

November 9, 2018

Abstract

We consider the problem of counting and of listing topologically inequivalent “planar” 4-valent
maps with a single component and a given number n of vertices. This enables us to count and to
tabulate immersions of a circle in a sphere (spherical curves), extending results by Arnold and
followers. Different options where the circle and/or the sphere are/is oriented are considered in

turn, following Arnold’s

classification of the different types of symmetries. We also consider the

case of bicolourable and bicoloured maps or immersions, where faces are bicoloured. Our method
extends to immersions of a circle in a higher genus Riemann surface. There the bicolourability
is no longer automatic and has to be assumed. We thus have two separate countings in non zero
genus, that of bicolourable maps and that of general maps.

We use a classical method of encoding maps in terms of permutations, on which the con-
straints of “one-componentness” and of a given genus may be applied. Depending on the orien-
tation issue and on the bicolourability assumption, permutations for a map with n vertices live

in S4y, or in Son.

In a nutshell, our method reduces to the counting (or listing) of orbits of certain subset of
Sun (resp. Sz,,) under the action of the centralizer of a certain element of S4,, (resp. S2,,). This

is achieved either by ap
orbits.
Applications to knot

Keywords:

pealing to a formula by Frobenius or by a direct enumeration of these

theory are briefly mentioned.

Embedded graphs; Knot diagrams; Immersed curves; Closed curves; Topological maps.

Mathematics Subject Classification 2000: 05C10, 05C30, 57M25, 83C47
/n/n1 Introduction

In the present paper we are interested in the problem of enumerating the (equivalence classes of)
curves with n double points that one can draw on the sphere or on an orientable surface of genus
g. Such curves may be regarded as the images of immersions of a circle in that surface. In the
present paper we shall be mainly dealing with immersions in a compact surface. See Fig. [1] for
an illustration of the difference between immersions in the plane or in the sphere. The problem is
tightly connected with the census of knots and virtual knots but we shall content ourselves with
brief comments about knots. Recall that for non zero genus, (virtual) knot diagrams or drawings of
curves exhibit virtual crossings in addition to their regular crossings: the former may be regarded
as artifacts due to the projection on the plane of the figure, see [I] and the example of Fig
Since the curves (or the knot diagrams), like the surfaces themselves, can be oriented, the discussion
and the results will naturally split into four cases (OO, UO, OU, UU) that we define now: a genus
g curve is the image of the circle under an immersion S! — 5%, the latter being an orientable

surface of genus g, and, if the curve is not simple (if it crosses itself), the multiple points of the
immersion should be double points with distinct tangents (in other words we consider generic
closed curves). When g = 0, this is called a generic spherical curve. Both the circle and the
surface can be oriented. If S! is not oriented, one may consider the sets UU and UO of Diff(=)-
equivalent and Diff*(=)-equivalent unoriented curves. If S! is oriented, one considers the sets OU
and OO of Diff()-equivalent and Diff*(©)-equivalent oriented curves. Difft(=) denotes the group
of orientation-preserving diffeomorphisms of the oriented surface %. For spherical curves, these four
types of immersions have been considered by previous authors, [2] [3] [4]. Correspondingly, in knot
theory one may consider knots up to mirror symmetry, and oriented or unoriented.

Following Carter [5], who coined this adjective in the UU case, one says that two immersed curves
are OO, UO, OU or UU geotopic if they are equivalent in the previous sense. Now it is clear
that the operation of adding handles to a surface in which a circle is immersed defines immersed
curves in higher genus surfaces. It is therefore natural to consider the following definition [5]: two
immersed curves are stably geotopic if and only if there is a collection of handles that can be
added to either surface, or both, in such a way that the curves become geotopic on the resulting
surfaces. In this paper we assume that the studied immersions are cellular, in the sense that the

complement of each associated immersed curve is homeomorphic to a collection of open disks, so
that the classifications obtained in this paper when g > 0 for the different kinds of immersions
should always be understood up to stable geotopy (although this will not be in general repeated in
the text). In other words the genus given in our tables for an immersed curve with a given number
of crossings is such that the chosen curve cannot be immersed in a surface of smaller genus. One

could then use surgeries to obtain a classification for all generic immersed curves (see [6]).
On top of the question of orientation, we introduce the issue of bicolourability of the curve. By
definition a curve is bicolourable if one can assign opposite colors to adjacent faces. While in genus

0, any self intersecting curve may be bicoloured (with adjacent faces of opposite colours), it is no
longer true for higher genus, see Fig. [2]for an example. Moreover when a curve is bicoloured, the two
possible colourings may be or not (topologically) equivalent, see Fig This bicolouring is quite
natural in the context of knot theory, where it amounts to considering the curve as an alternating
knot, see Fig. ig below; there are two ways of doing that, which may or not lead to equivalent
knots. We shall thus append a suffix c, b or no suffix at all to the symbols OO, OU, etc: OOc
will refer to (inequivalent) bicolourings of immersions of an oriented circle in an oriented surface,
OOb to bicolourable (but not bicoloured) immersions, and OO alone to general, bicolourable or
not, immersions. Likewise for immersions of type UO, OU and UU. This results in 3 x 4 = 12
different types of immersions, and the reader who is eager to see numbers may jump to Tables |9}
to see their cardinals tabulated up to 10 crossings for all genera. The reader who prefers figures to
numbers is directed to Fig. [15] and [L6{17] for a complete list of indecomposable irreducible spherical

/n/ncurves of UU type, with respectively n = 8 and 9 crossings.

cco BD) OS

CoO

©

Figure 1: Immersions of an unoriented circle with two double points. The five immersions in the
plane give rise to two distinct immersions on the sphere, for instance the two lying on

the left.

<>

SZ

x >

Figure 2: The diagram on the left describes a genus 1 immersion and is not bicolourable. The
little blue circle encircles a virtual crossing. On the right, the same immersed in a torus.

VY) , S

Le y ; ) Ne Q 7 J)

Figure 3: Two immersions of an unoriented circle with n = 6 double points. Distinct on an oriented
sphere, but equivalent on an unoriented sphere.

For g > 0 immersions they are few exp.

[7] and {8}.

We shall regard curves with simple crossings (images of immersions) as 4-valent maps. Our im-

icit results made available in the literature, see howeveil!]

mersions, being cellular, indeed define maps} recall that a map is a graph embedded in a surface

with its 2-cells (aka faces) homeomorphic

will be used repeatedly in this paper, in particular when using
genus of embedded curves. We should insist on the fact that in
sions/maps, bicolourable or not: all the curves that we consider have a single connected component

(in the language of knot theory, we are in

erested in knots, not

Matrix integrals in the large size limit which are quite effective

o open disks. The fact that faces do not contain handles

he Euler formula to determine the
his work we consider circle immer-

in links).
or the counting of maps of a given

genus fail to distinguish maps with different numbers of components. We thus use an alterna-
tive method regarding maps as combinatorial maps, i.e., maps described by pairs of permutations,

' The latter reference (that we discovered at a later stage of our wor!

) contains, for the UU case, a table of

isomorphism classes of immersions, with given genus and a given number of crossings (up to five), obtained using

Gauss diagrams and a method described in [5].

?They also define cellular embeddings of particular graphs called “simple assembly graphs without endpoints” in

[9], see also [10].
/n/nFigure 4: Immersions of an oriented circle. Left :

A, &®

ann =

3 immersion not equivalent to its reverse;

in contrast, the trefoil is equivalent to its reverse.

Figure 5

|UUc| and 1 to |UU

ollowing an

ive in S4,, or

ient by a re
combinatoria

idea, where t.
4n)! limits i
duce a better
ry peroctahec
ypes of bico

Swapping colours :
diagrams on the bottom are (on the sphere, of course).
|, the last two contribute 1 to both.

This method,

The set-up of

for the pair of

old idea by Wa

yicolourability assumption,
in Sap.
however, yields
abelling group

To obtain
This

labelled maps.
1as to be performed.
the paper is as follows.
he two permuta'
practical use

Ss
coding by pairs of permutations of S2,. Or
ra.

oured or bicolourable immersions that may

some relations between the numbers of these different types (Theorem [Ap. In Sect.
he assumption

of bicolourability and encode the genera

sh and Lehman [12], or some variants.
componentness” and of fixed genus may be easily enforced in that description. Depending on the
orientation issue and on the

maps under the action of some subgroup of
In Sect. 2, we present the simplest version of the previous
ions encoding general immersions live in S4p.
yeyond n = 6. In Sect. 3, we consider bicolourable maps and intro-

the two diagrams on the top are not equivalent, while the two

The first two contribute 2 to

The constraints of “one-
permutations for a map with n vertices
unlabelled maps and immersions, a quo-
is achieved by considering orbits of the
the permutation group.

The rapid growth of

vits of these pairs under the action of the

group yield immersions of type OOc. Sect. 4 is devoted to a study of the various

be derived from the OO type. We derive
5, we remove

maps and immersions by another choice

yermutations of Sen. Sect. 6 and 7 gat

and on the a

algorithms usec

pp

for counting orbits, Appendix B conta‘

1er results, comments on the asymptotia

ication to knot theory and our conclusions. Appendix A gives some details on the

ins several tables of interest that will be

described later, and Appendix C reviews the connection between maps and Feynman diagrams of
matrix or scalar integrals.
A notational comment: in the following, we make use of two notations for the cardinal of a set

X, either |X|

or #X.
/n/n2 UO immersions, first method using permutations of S,,

2.1 The subset X = [2?”] of S$), and its orbits (“X method”)

In the present section, we obtain the number of circle immersions of type UO, with n crossings,
by counting the number of orbits of solutions for a particular set of equations written in the group
S4n, under the action of a particular subgroup. We shall actually recover part of these results later,
with other methods, which are faster (see Sect. [3] and [5), but the technique presented here has an
interest of its own.

Method: description of a curve by a permutation belonging to a particular conjugacy
class X of S4n.

In a first stage, we consider a labelling of half-edges of the maps. For a 4-valent map with n
vertices, there are 4n such half-edges, and we consider the symmetric group S4, acting on these
labels. We choose a € [4”] Bjto describe the clockwise linking pattern of half-edges at the vertices,
and consider all possible pairings of half-edges (propagators in physicists’ parlance) encoded in
permutations T € (2?”]. Note that this method of labelling half-edges is not original, it has been
used by Walsh and Lehman [12] and rediscovered later by Drouffe, as quoted in [13].

Example of encoding See below in Fig. [6] the map encoded by

= (1,2, 3, 4)(5,6, 7, 8)(9, 10, 11, 12)(13, 14, 15, 16)
cL 13) (2,5)(3, 6) (4, 16)(7, 8)(9, 12)(10, 15)(11, 14)

in cycle notation.

Orbits of X = [2?"] for the adjoint action of the centralizer of an element of [4”]

Theorem 1. Call o = (1,2,3,4)(5,6,7,8)...(4n — 3,4n — 2,4n — 1,4n) € [4"] C San, using cycle
notation, and Cg = C(S1n,0), the centralizer of o in San. Let X = (2?”] denote the conjugacy class
of San whose elements are products of 2n transpositions. Then we have :

Circle immersions of type UO, i.e., immersions of the unoriented circle in an orientable and ori-
ented surface of genus g, are in bijection with the orbits of Co acting by conjugation on the set of
permutations T that belong to X and solve the simultaneous equations:

o?r € [(2n)?] (1) one — componentness

c(oT) =n+2— 29 (11), genus condition
where c(x) is the function giving the number of cycles (including singletons) of the permutation x.

Proof. That labelled maps are in one-to-one correspondance with pairs (0,7) has been known for
long [12]. The sequence of labels as one goes across the crossings is described by the permutation
o?7, and imposing condition (I) ensures that the curve has a single component (hence also that the
graph is connected). Condition (II), follows from Euler relation, if one realizes that the number of
faces of the map is just the number of cycles c(a7T), (another observation made by many previous
authors...). A change of labels by 7 € S4n acts on o and 7 by conjugation: (0,7) > (07,77),
with a7 := yay~!. The form of o as well as conditions on permutations 7 of the type (I), (I]),,
(I)N(D)g, are invariant under the action of any y in the centralizer C, of a, ie.,

T satisfies (I) and/or (II), , y€Co => 7” satisfies it too.

’The notation [-] refers to the conjugacy classes of the permutation group
/n/nHeuristically, C, is the group of reparametrizations (relabellings) of the edges of the diagram
that leave the pattern of edges around each vertex unchanged. Quotienting by that group, i.e.,
considering its orbits for the adjoint action thus enables one to go from labelled maps to unlabelled,
topologically distinct maps. Finally note that the definition of o as describing the, say, clockwise
linking pattern at vertices has singled out an orientation of the surface, while no information about
the orientation of the circuit described by 027 is provided: the maps are naturally asssociated with
immersions of an unoriented circle in an oriented surface, hence of type UO in our nomenclature.

We shall use the following notations for the relevant subsets of X = [2?”]:

X'’={re [2?"| | ore [(2n)?]}
X, ={re [2?"| |o?re [(2n)?} and oT has n + 2 — 2g cycles}.

In particular we denote X"” = X4, corresponding to planar (in fact spherical) maps. The family of
sets X, 4 is a partition of X’, and the set of orbits of the latter (identified with circle immersions), for
the adjoint action of the subgroup C,, is also partitioned into orbits corresponding to the various
circle immersions of genus g.
Remarks.

(i) In the group $4n, the function c is related to the (n-independent) length function ¢ by (x) =
4n — c(x). Therefore equation (II), also reads ¢(07) = 8n — 2+ 2g.

(ii) In the wording of the theorem we made a convenient choice for ¢; this is actually irrelevant
since the choice amounts to labelling the half-edges in a specific way.

(iii) An arbitrary curve has c(or) =n +2-— 2g > 1, therefore the possible values of g are such that
2g<n+l1.

Examples. Let us choose n = 4, then
o = (1, 2,3, 4)(5, 6, 7, 8)(9, 10, 11, 12)(13, 14, 15, 16) in cycle notation, equivalently
o = [2,3,4,1,6,7,8,5, 10, 11, 12,9, 14, 15, 16, 13] in list notation.
First example: 7 = (1, 13)(2,5)(3, 6)(4, 16)(7, 8)(9, 12)(10, 15)(11, 14).
One checks that o?7 = (1,15,12,11, 16, 2,7,6)(3,8,5, 4, 14,9, 10,13) € [87], so 7 obeys condi-
tion (I) and therefore encodes an immersion (possibly non-spherical). One then evaluates 07 =
(1, 14, 12, 10, 16)(2, 6, 4, 13)(3, 7, 5)(11, 15); its number of cycles is 6 (there are two unwritterf] sin-
gletons: (8) and (9), so that the genus is 0, and the immersion is actually spherical. The immersion
encoded by permutation 7 is given in Fig. [6 Notice that 1-cycles give rise (or come from) kinks,

also known as simple loops.

Figure 6: The diagram encoded by
7 = (1, 13)(2,5)(3, 6)(4, 16) (7, 8)(9, 12) (10, 15) (11, 14).

Second example: + = (1,8)(2,3)(4, 16) (5, 13)(6, 12)(7, 14)(9, 15)(10, 11).
One checks that o?7 = (1,6, 10,9, 13,7, 16, 2)(3, 4, 14,5, 15,11, 12,8) € [8?], but this time or =
(1,5, 14, 8, 2, 4, 13, 6, 9, 16)(7, 15, 10, 12) which has two 1-cycles (3) and (11), and therefore a number
of cycles equal to 4, so the permutation 7 describes an immersion in a surface of genus 1. The
encoding is made explicit in Fig. Notice that this circle immersion has four real crossings, as
expected, but also one virtual one.

4Since n is fixed, it is unnecessary to write explicitly the 1-cycles when using the cycle notation, but one should
remember that the function c(x) should count the total number of cycles !
/n/nFigure 7: The diagram encoded by
7 = (1,8)(2,3)(4, 16)(5, 13) (6, 12)(7, 14)(9, 15)(10, 11).
The virtual crossing is indicated by an open circle.

2.1.1 Counting orbits

One would like to count the orbits for the C, action on the sets X, X’, Xx; and in particular on
X" = X4. How to find a priori the number and the lengths of the C, orbits ?

Burnside’s lemma asserts that the number of orbits in, say, X’ is related to the total number
>, |X| of fixed points in the action of & € Cy acting in X’, ie., the number of pairs («,€) such
that K€ = Ek, by
D1" a)
ICol

This implies, however, the computation of |X’| x |C,| pairs of products (Ké,€«), which becomes
prohibitively large for n > 6.

|X'/C,| = #C,—orbits in X’ =

Orbits, double classes and a formula by Frobenius. Let us first state a simple but useful
theorem (that belongs to the folklore)

Theorem 2. Let G be a finite group and H be a subgroup of G. Take x € G and call Cl(x) its con-
jugacy class. Then the orbits for the adjoint action of H on Cl(a) are in one-to-one correspondence
with double cosets H\G/K where K = C(G,2) is the centralizer of x in G.

Proof. Let « € G. Then y,y' € Cl(x) belongs to the same H-orbit iff Sh ¢ H: y! = hyh~', but
y = geg' and y! = g'rg’—', hence g/rq’! = hgxg th! or g'“hgx = xg'—'hg, from which it
follows that k := g!~'hg € K := C(G,2) and g! = hgk-! € HgK.

The counting of H-orbits in Cl(x) thus amounts to the counting of these double cosets. Frobe-
nius has given a formula for the number of double cosets H\G/K. In essence his method
consists in computing in two different ways the number of solutions of equation hgk = g with
g€G,heH andke K, with the result that

\H\G/K| - yy Ml »
7

|| || IGul

where the sum runs over conjugacy classes G, of G, Hy, = HONG, and K, =KN Gy.

We are going to make repeated use of this connection between orbits and double classes and of
Frobenius’ formula. In the problem at hand, G = S4,, there is a one-to-one correspondence between
the orbits of 7 € Cl= X = (2?"] under the action of H = Cz = C(S1n,0) and double cosets of
San of the form C,\S4n/C,; with C, = C(S4n,7). In this particular case of permutations, Frobenius’
formula is easy to apply without calculating explicitly the intersections: classes G',, are indexed by
partitions, and H,,, K,, can be simply deduced from the knowledge of the cyclic structure of their
own conjugacy classes. Note that this method allows one to count the C,-orbits in X, but not those
in X’ or in X”.
/n/nPoor man’s method. In the latter case, the same group theoretical considerations are not
applicable, and we resort to a direct construction of these orbits on a computer. This “brute
force” method has the merit of giving not only the number and lengths of orbits, but also an
explicit representative of each of them, thus providing a catalogue of the corresponding maps or
immersions. In practice, this method may be used up to n = 6. For higher values, we resort to
alternative methods presented in the next sections.

2.1.2 Orbits lengths

The length of orbits, for the C, action on any of the sets X, X’ or X’ 9° is not constant. For instance,
when n = 4 there are 121 orbits for the C, action on X’ (21 of genus 0, 64 of genus 1, and 36 of
genus 2), but they are not all of the same length: 92 are of maximal size (namely 6144, the order of
Cz), 23 are of size |C,|/2, and 6 are of size |C,|/4). This corresponds to the fact that the centralizer
C(C,,T), in C,, of a permutation 7 describing some specific immersion is not necessarily trivial,
and #Orb(r) = |Co|/|C(C.,7)|. Existence of “symmetries”, for a specific immersion, is measured,
or actually defined, by C(C,,7). The order w of this group will not be given in our tables, but it is
easy to obtain for every particular case. For large n, almost all orbits have trivial stabilizers [15],

and an estimate for the total number of immersions, including all values of g, is asymptotically
4°n!

given by |X’|/|C,|, equal to (n= 2)" when n > 2 (see below, Appendix C and Table

2.2 Results

The group C,. Given a € [4"], i.e., a product of n cyclic permutations on n disjoint sets of 4
objects, its centralizer C, is made of cycles operating on the n same sets of 4 objects, times any
permutation of these n cycles. Whence the order

ICo| =4" nl,

ie. |Co| = 4,32, 384, 6144, 122 880, 2949 120--- for n = 1,2,3,4,5,6, see Table}

The set X = [2?"] and its C,-orbits. A standard result is that |X| = (4n — 1)!.
How many orbits are there when C, acts by conjugation on the class X = [2?"] ? By use of
Frobenius’ formula for double cosets (2) we find that for n = 1,2,--- ,9, there are

#C,—orbits in X = 2, 10,54, 491, 6430, 119 475, 2775 582, 76 733 201, 2439149685. — (3)

One is of length 1: the orbit of o?.

The set X’ and its C,-orbits. We prove in Appendices C.2 and C.3, using a simple integral
calculation or a purely combinatorial argument, that |X’| = (4n — 2)!!. Acting on that X’, C, has
a number of orbits given by

#C,—orbits in X’ = 1,3, 13, 121, 1538, 28010,--- (4)

Taking n = 4 for example, using the orbit stabilizer theorem and denoting as above by w the
order of the centralizer C(C,,7), one finds that there are 92 orbits in X’ with w = 1, 23 orbits
with w = 2 and 6 orbits with w = 4, a total of 121. One checks that 92|C,| + 23|C,|/2 + 6|C,|/4 =
645120 = |X|, as it should. Moreover #(Co\San/Cr) = 491 corresponding to the C,-orbits of X,
but only 121 correspond to orbits of X’.
/n/nThe number of C,-orbits in X”. Among the C, ort

nits in X’ we pick those that are such

that o7 has n + 2 cycles (condition (IIo for genus 0). We find a number of relevant orbits equal
to 1, 2,6, 21,99, 588,---. As discussed above, those are the numbers of immersions with n double
points of an unoriented circle in the oriented sphere, see Fig.|8} [2 [IT] and OEIS sequence A008987.

#UO spherical immersions = 1, 2,6, 21, 99, 588, 3829, --- (5)

In fact the number 3829 (for n = 7) and further terms will be obtained below through a different
method.

The following Table[I]summarizes, for n = 1,...,6, most of the results obtained using the above

technique. The number of immersions in surfaces of specific genus g > 0 can be obtained in the
same way (only the spherical ones appear in Table[I) but the corresponding values are gathered in

Ta dle [9] because we shall later recover and extend the resu

ts obtained in the present section. The

last line of Table [1] refers to a quantity (free energy) defined in Appendix C.

Table 1: Orbits of X subsets. X = (2?”). The numbers in blue give the asymptotic estimate of

the number of orbits. The numbers of spherical

UO immersions are given by the line

# C,-orbits in X”. The total numbers of UO immersions (all genera) are given by the line

# C,-orbits in X’. Last entry F\° of the Table

is defined in Appendix C.

X/|Col Ty 3 7 10 105

n 1| 2 3 4 5 6

C,| = 4"n! 4] 32 384 6144 122 880 2949 120
X| = (4n — 1)! 3 | 105 | 10395 | 2027025 | 654729075 | 316 234 143 225
# C,-orbits in X 2} 10 54 491 6430 119 475
X’| = (4n — 2)! (DZ) |] 2 3840 | 645120 | 185794,560 | 81749606 400

1512 27 720

xX" (DNADo 1344 | 99840

11034624 1646 100 480

558.17

ho] |b]

FOU Lx

Z 65
2 4

X"/\Co 3.5 16.25 89.8
1

449 3349
5 6

"A, Pe co & Ooo OB

Figure 8: Immersions of an unoriented circle in the oriented sphere with n double points, for

n=1,2,3
/n/n3  Bicolourable and bicoloured maps of types UO and OO us-
ing Sop.

In a nutshell: here we shall get UOc, the bicoloured immersions of type UO, then, forgetting the
colour assignment, we shall get UOb, the bicolourable immersions of type UO, which turns out
to be identical to the immersions UO for genus 0 maps (spherical curves). This will be explained
below.

3.1 The set Y = S},, its orbits, and immersions of type UOc (“Y method”)

In the present section, we shall study the orbits of solutions for a particular set of equations written
in aset Y defined as the symmetric group S2,, itself, under the action of a particular subgroup that
turns out to be its hyperoctahedral subgroup.

Method: description of a bicoloured map by a pair of permutations of Y = S2,. It is
a well known fact that planar maps with vertices of even valency may have their faces bicoloured.
This applies of course to our 4-valent planar maps. For non planar (i.e., of genus g > 0) maps,
this is no longer guaranteed, (as already discussed in the Introduction and examplified in Fig.
and we have to assume that the map is bicolourable, see below. We then turn to a more efficient
encoding of such bicoloured maps by permutations [16].
For a bicoloured map with n vertices and 2n labelled edges, we deal with permutations of Sop,
instead of S4, as above. A map is encoded into a pair of permutations 0,7 € Son: o describes
the sequence of edges as white faces are traveled clockwise, while 7 describes the counterclockwise
sequence of edges on shaded faces, see Fig. Dh. When considering the map as (the plane projection
of) an alternating knot, one uses the convention for overcrossings/undercrossings shown on Fig. |9b.
Define p = o'r and f = o77!; it is clear that p describes the pairings of edges at overcrossings,
and f at undercrossings, and they are both a product of n disjoint transpositions, p, p € [2"]. The
chain of edges as one follows a thread of the knot/link is thus described by pp = a~!tor~!
white, resp. shaded, faces correspond to cycles of o, resp. T.

, and

Figure 9: White and shaded faces + over/under-crossings

Just as in Sect. the two conditions of one-componentness and genus g amount to imposing

lro7~! has 2 equal cycles, i.e. pf € [n7]. (I) one — componentness

c(a) +ce(7) =n +2—2g (II’), genus g

pp=o

We want to count all o and 7 subject to the above conditions. Actually, it is convenient to
fix p in [2"], defining it for example by p = po, po(2i — 1) := 2%, po(2i) = 28-1, i = 1,---n (it
is only a relabelling of the edges). This choice being made, a map is then described (up to the
conjugate action of the centralizer of p, see below) by a single permutation o, since tT = ap. Notice
that p = opo~'. With this choice for p, the two conditions (I’) and (II’), can be written in terms
of equations for o (see theorem [3| below).
/n/nAs in Sect it is natural to define the subsets Y’ and yy of Y, made of those permutations 7
that respectively obey the conditions (I’) and (I')N(II’),. The sets Yj constitute a partition of Y’.

Ultimately, in order to count the number of curves, one decomposes the previous subsets Y>; in
particular Y” = Yj for spherical curves, into orbits for the conjugate action of Cy, the centralizer
of po in Son.

Finally, we observe that the convention that o describes the clockwise sequence of labels on
white faces (and 7 the counterclockwise one on shaded faces) assumes that the sphere or the higher
genus surface is oriented, while nothing specifies the orientation of the curve. Our orbits, in this
section, are thus of type UO.

Bicoloured versus bicolourable curves. One could think that the orbits of yy should deter-
mine the various UO circle immersions of genus g. This is not so for two reasons, already mentioned
in the Introduction. First, the curves obtained in this way correspond to a bicolouring of a curve.
For lack of a better name we call “bicoloured immersions” the bicoloured curves associated with
the orbits of Y; (recall that in the language of knot theory, they describe alternating knots), and
denote their set by UOc. Depending on whether the two alternative colourings (i.e., the two choices
of alternating over- and under-crossings) are or not topologically equivalent, they will contribute
differently to the counting of ordinary, uncoloured immersions; this will be spelled out in Sect.
Secondly, for genus g > 0, not all curves are bicolourable, see Fig. [2] for an example. We shall call
“bicolourable curves” or “bicolourable immersions” (not to be confused with the bicoloured ones
previously described) the curves obtained by this technique, after erasing the colours, and denote
their set by UOb. Finally we recall that UO refers to immersions studied in the previous section,
with no assumption of bicolourability.

In the Tables |9} and |8} the reader can find the cardinals of these various sets of immersions, and
check that |UO| = |UOb| in genus 0, while for g > 0, |UO| > |UOb|, as expected since bicolourable
curves do not exhaust all possible genus g curves.

Example of encoding See in Fig. [10] the example of the bicoloured diagram described by o =
[3, 5, 7,1, 2,6, 4,8] = (1,3, 7,4)(2,5)(6)(8) and 7 = [5,3,1,7,6,2,8, 4] = (1,5, 6, 2,3)(4, 7,8), hence
p = [2,1,4,3, 6,5, 8, 7].

We summarize the above method as follows:

Theorem 3. Call p = (1, 2)(3,4)...(2n—3,2n—2)(2n—1, 2n) € [2"] C Son, using cycle notation,
and Cy = C(San, p), the centralizer of p in Son. Bicoloured circle immersions of the unoriented
circle in an oriented surface of genus g, or UOc immersions for short, are in bijection with the
orbits of Cp acting by conjugacy on Son whose representatives o solve

po po has 2 equal cycles, i.e. pf € [n?] with p=apa7! (I')
c(o) +c(op) =n+2—2g (II'),

c(x) being the function that gives the number of cycles (including singletons) of the permutation x.

Remarks.

(i) In the wording of this theorem we chose a particular value of p in the conjugacy class [2"],
namely p = po, because it is simple and convenient, but we could have made any other choice in
the same class since this just corresponds to a relabelling of some edge labels. We shall see in Sect.
[8.2] how to further restrict the choice of o.

(ii) It is useful to remember that p* = p? = 1, that p = p” since, by definition, p? = apa
that T = op = po.

(iii) The set Y’ defined by condition (I’) alone can also be written Y’ = {o € So, : ofa! € [n*]}.

1 and

10
/n/nFigure 10: The bicoloured diagram encoded by
o = [3,5,7, 1, 2,6,4,8] = (1,3, 7, 4)(2, 5)(6)(8)

Example. As an example we give in Fig. [I0|the diagram of Fig. [6in this new description.

Structure of the centralizer. The centralizer Cp of po is generated by transpositions of (1, 2),
3,4),...(2n — 1,2n), times a permutation of these n pairs. Its order is thus 2”n!. This group
is called the hyperoctahedral group BC, as it is the group of symmetries of the n-cube. It
admits several different geometric and algebraic presentations. One construction is as follows (see
‘or example [I7]). The symmetric group $2, acts on {1,2,...,2n} and therefore also on the set of
partitions of the latter consisting of two-element subsets. Fix an element in this set (we shall choose
{{1, 2}, {3, 4}, {5, 6},...,{2n — 1, 2n}}) and denote by C, its stabilizer. Clearly, C, permutes the n
wo-element subsets among themselves and it is equal to the centralizer, in S2, of the permutation
p = (1,2)(3,4)...(2n — 1,2n), whence the notation. The subgroup Cp of S2n then appears as the
semidirect product of Sz x... x S2 (n times) and S),, the latter acting by permuting the factors of
he former (wreath product).

In order to put in perspective what will be done in Sect..[3-2] let us make a few additional remarks.
Call w the map Syn ++ Son defined by w(x) = prp~!. Clearly @ is a group homomorphism and
an involution, moreover the subgroup C, is the set of fixed points of this involution: C, = {x :
x € Son, | a(x) = 2}. Define the map (not a group morphism) y : Sen 4 Sen by v(x) = w(a7!)a.
Notice that y(a—!) and y(x)7! belong to the same So, - conjugacy class since they are conjugated
in Son : y(a)—t lo(a)a. We have also v(x)! = pxpa-', so that p being fixed, the
condition characterizing the one-componentness of the permutation x encoding a curve reads simply
g(x) € [n?]. The reader will easily notice (see also [[8]) that, for any k in Cy, y(kx) = v(x) and
(ak) = ky(a«)k7!. Therefore y induces a map from the space of double coset | Cp\S2n/Cp to
the set of conjugacy classes in S2n. Actually, we shall see in Sect. that the counter image
Y’ = y"1({n?]), considered as a subset of C,\S2n/Cp, contains only one element: the double coset
Cp\B/Cp, where B = (1,2,3,...2n). As a double coset, Y’ is then a disjoint union of left cosets
oCp, with o € Syn (they will be identified with the sets V(r) of Sect. 3.2), parametrized by the
homogenous space R = C,/C,M ce = C,/Dn, where Dy is the dihedral group. The space R,
with |C,|/|D| elements, will be described in Sect. as parametrizing the “gauge condition” (in
physicist’s parlance).

=z

Orbits of Y’. One finds |Y’| = 2?”"!(n — 1)!n!, see Appendix C.4 for a proof based on a simple
integral. In practice, the orbits of Y’ are obtained by methods similar to those of Sect.|2| (see also
Appendix A).

Orbits of Y” = Yj and of Yj. Once the orbits of Y’ are known, filtering according to their genus
yields the orbits of each Yj, in particular of Y" = Yj. For n = 10, we had to rely on a random
sampling method (see Appendix A), but as we have no a priori knowledge of |Y”|, we have no way
to check the correctness of the result. The figures entered in red in Table [2] below, for n = 10, are
thus likely estimates, awaiting an independent confirmation.

5A graphical way to encode these double cosets is described in [19], p. 401, see also [18].

11
/n/nOrbit lengths. Lengths of orbits of Y’ may be read off the following table, with the notation
k#orbits of length \Cp|/k

n=1 2?

n=2 1! 2?

n=3 1 2 3? 6

n=4 1" 2e at

n=5 1352 962 54 102

n-6 13803 962 3h 66

n=7 145696 2766 76 142

n=8 1644736 752 428 gs

n=-9 y10315716 912264 3202 622 98 18?

Results. The numbers of orbits for g = 0 are given in Table |2} for higher values of g they are
gathered in Table [9] under the entry UOc.

3.2 The left coset U = 6C, and immersions of type UOc and OOc (“U method”)

In a nutshell : we shall see in this section that, in order to determine the number of immersions
of type UOc, we can replace the set Y’ studied in the previous section by a particular subset U (a
particular left coset of Cy) and the adjoint action of Cp, by its restriction to the dihedral subgroup
D,, which is much smaller. Moreover, by replacing the adjoint action of D, by the adjoint action
of Z,, (a particular cyclic subgroup of the latter), one obtains the number of immersions of type
OOc. In Sec . we shall see how, from this study, and by introducing several involutions, one can
obtain the various types of immersions. As a side result we shall also see how the stratification of
U into subsets of genus g allows us to recover (in genus 0) the classification of the so-called “long

curves” and to obtain new classifications when g > 0.

a. The set R. With p = (1,2)(3,4)---(2n — 1, 2n) fixed as before, what can be said about the
values of p = opo—! as 0 € Y’ ? Consider the sets

R= {plop € [n"}} (6)
and for r € R,

V(r) := {o (7)

apo * =a'po'~ lop

opot=r}.

1 1 /

oO

It is readily seen that V(r) is a left coset of Cp, since o,0’ € V(r)

po'—to, hence a’~!g € Cy anda € o'Cy. This pro
implies that |V(r)| = |C,| and from the fact that

it follows, using the values of |Y"| and |C,| calcu

b. Further gauge fixing. One may now restr:

verty of being a left coset will be used shortly. This
Y’ may be partitioned into V(r), Y’ = U,erV(r),
ated above, that |R| = |Y’|/|C,| = 2"-1(n — 1)!.

ict further the set of admissible o by imposing the

additional condition (on top of p fixed as above

pp= opo'p =a fixed in Rp,

or equivalently o € V(ap). For example one may demand that opo—!p be the product of the two

cycles
opo'p = ag := (1,3,5,--°,

This latter choice ag corresponds to a sequentia.
is travelled one way or the other. We call U the

U ={olopo'p

2n — 1)(2,2n,2n — 2,--- ,4). (8)

] labelling of edges by (1,2,3,---2n) as the curve
set of o such that

= ao} = V(aop), (9)

12
/n/nta

Table 2: Orbits for Y subsets.
The numbers in blue give the asymptotic estimate of the number of orbits.
Numbers of spherical UO bicoloured immersions appear on the line #C,-orbits in Y”.
Total numbers of UO bicoloured immersions (all genera): line #C,-orbits in Y’.

Last entry BOYD of the Table is defined in Appendix C.

Here and below in this paper, figures in red are still awaiting confirmation, see above and Appendix A for explanations.

n 1 2 3 4 5 6 7 3 9 10
[Cp] = 2" n! 2 8 48 384 3840 46 080 645 120 10 321920 185 794560 3715 891 200
TY] = [San] = (Qn)! 2 24 720 40 320 3.628 800 479 001 600 87 178 291 200 20 922 789 888 000 6 402 373 705 728 000 2 432 902 008 176 640 000
#Cp-orbits in Y = San 2 EJ 34 182 1300 12634 153 598 2231004 37 250 236 699 699 968
ly’| = ne 1)!n! 2 16 384 18 432 1474560 176 947 200 29 727 129600 6 658 877 030 400 1917 756 584 755 200 690 392 370 511 872000
ly I/lCpl = as 1)! 1 2 8 48 384 3840 46 080 645 120 10 321920 185 794560
ly") 2 16 336 12 480 689 664 51440 640 4870 932 480 561 752 432 640 76 597 275 525 120 12 077 498 082 263 040
IY" 1/ICpl 1. 2 7. 32.5 179.6 1116.33 7550.43 54423.3 412 268.66 3.250 229.2
POD — 17 71a 7 5 449 3349 52.853 217693 618403 5125573

e aan) 2 g t $ é rc S 3 8

Table 3: Orbits for Z subsets.
Numbers of spherical OO immersions: line #C;-orbits in 2".
Total numbers of general OO immersions (all genera): line #C/-orbits in Z’.

7 TT] 2 3 a B 6 7 8 i) TO
Cant T [2 6 24 120 720 3040 40320 362 880 3628 800

2
[Z| = Qn — 1)! 1 [6 | i120 | 5040 | 362880 [| 39916800 | 6227020800 | 1307674368000 | 355687428096000 [ 121645 100408832000
|Z/|/|c,| = Gao 1] 3] 20 210 3024 55.440 1.235 520 32432 400 980 179 200 33 522 128 640
[Z7] Tp4/, a2 780 21552 803 760 38.054 160 2194345 440 149 604 053 760 11794431 720 960
ZC!) = apr 65 398 3349 52853 217693 1236806 1146
[2 \/1C,| = 2s rlet7 Ls 2 z : z f sem

/n/nand we recall that
|U| = |C,| = 2"n!.

Proposition 1. The general solution of (9) is 0 = BE, with B the cyclic permutation B =
(1,2,3,---2n) and € arbitrary in Cy. In other words, U = BCy, a particular C,-left coset, in
agreement with the previous argument.

Proof. It is easy to check that 8p8—!p = ag, hence upon the change of variable o = Bé, equ. (9)
reads BEp€—'B-p = BpB-'p, hence EpE-! = p, E € Cp.

The above parametrization of a as an element of the left coset U therefore automatically implies
condition (I’). This is very useful in practice (see a comment at the end of Appendix A).

c. The remaining reparametrization groups. In this new “gauge”, the remaining labelling
freedom on a given o is the choice of the origin (edge number 1), and the direction of travel if
one considers unoriented curves. Accordingly the group of reparametrization, C, Ca, where Ca
is the centralizer of a in S2,, is the dihedral group D,, (of order 2n) if one considers unoriented
curves, and the cyclic group Z,y if the curves are oriented. Unlabelled curves are thus in one-to-one
correspondance with orbits of the set U under the adjoint action of D,, (unoriented curves) or of
Zn (oriented ones).

Remark. This occurrence of the dihedral or cyclic group makes clear that the length of orbits which
must be divisors of the orders of these groups, are divisors of 2n or n, a “well known” fact.
Warning: Y’ is stable under the adjoint action of Cp and can be decomposed into the corresponding
orbits, but its subset U is not stable under this action, although it intersects all the orbits of Y’
(not only once, in general); U is however stable under the action of D,. See Appendix A for more
details.

d. Back to |Y’| and |R|. The number of left cosets contained in a double coset K\g/K, for g an
element of a group G, and K, a subgroup of G, is equal to the index, in G, of the subgroup KN KY,
where K9 = gKg"!. In the present situation, with G = Sy), K = Cp, and g = § (the above cyclic
permutation), we have Cp ce = D where D is the dihedral subgroup of C, (see also [19], p. 402).
The previous index is therefore |C,|/2n. Since all C, left cosets have the same number of elements,
the number of permutations contained in the double coset Y' = C,\8/C, is equal to |C,| x |C,|/2n:
we recover the number of elements of Y’. As a double coset, Y’ is a disjoint union of left cosets
V(r) parametrized by the homogenous space R = C,/C,M cP =C,/D.

e. The set U, of long curves. The set U just defined may be partitioned into U, according
to genus, as was done before for Y’, and each U, may be interpreted as the set of rooted maps
on an oriented surface © of genus g, or in other words, of (equivalent classes of) open (and ori-
ented) curves drawn in ©, sometimes dubbed long curves. In genus g = 0 their number have
been computed in [20] up to n = 10, and in [2]] up to n = 19 crossings using transfer matrix tech-
niques. (Their asymptotic behavior has also been studied using a method of random sampling [22].)

Proof. Consider a rooted 4-valent genus g map with n crossings and one component: the marked
half-edge that we label by 0 may be regarded as cut open, which transforms the map into a “long
curve”. We then label by 1,2,--- ,2n the successive edges encountered along the curve. The curve
may then be bicoloured by assigning to the left of the marked edge the colour say white, and then
alternating colours as we go from a face to an adjacent one. To completely describe the pattern

of crossings of the curve, it remains to give the permutation o satisfying the rules of the previous
formalism, namely conditions and genus g. There is a bijection between these rooted maps and

14
/n/nelements of the set U,. There is no reparametrization freedom left, hence no orbit to take, once
the root has been fixed. Then any such open curve may be closed by identifying edges of labels
0 and 2n. Topologically distinct closed curves, i.e., images of immersions, correspond to orbits of
the set U, by the reparametrization group, namely the cyclic group Z, or the dihedral group Don,
depending on whether the curve is oriented or not (OOc resp. UOc).

Thus one finds a decomposition of the 2"n! curves of U, (n = 0,1,--- ,9), according to genus as
1 1
2 2
8 8
48 42 6
384 260 116 8
# open curves = 3840 =~ 1 1796 1700 344 (10)
46 080 13396 22528 9700 456
645 120 105 706 284 284 220570 34560
10321920 870772 3488904 4392820 1506576 62 848
185 794 560, 7420836 42074568 79951716 49572528 6774912

with the first column (genus g = 0) in agreement with [20] [21]. Notice that the sum over all genera
is of course equal to |C,| = 2”n!.

f. Orbits of U and UOc and OOc immersions. The same sort of counting of orbits that was
done in the sets Y’ and yy may be carried out in the sets U and Ug. From the previous discussion
it follows that UOc immersions are orbits of U under the action of Dn while its Zp-orbits are what
may be called OOc immersions. The numbers of UOc immersions have been computed before, see
Table 2) using the C, action on Y’, but can be recovered in a more economic way, using the Dy
action on the set U. Here are the numbers of OOc immersions and their distribution according to
genus forn =1,--- ,9.

2 2
6 6
20 18 2
108 74 32 2
# curves of type OOc = 776 = 364 340 72 (11)
7772 2286 3780 1630 76
92172 15106 40612 31510 4944
1291048 109118 436368 549334 188356 7872
20 644 140 824612 4675012 8883620 5508120 752776

See also Table [9] For even n, the numbers of such orbits are just the double of those of type UOc,
while for g = 0 these numbers are the double of OO immersions, see the proof below in Sect.
Theorem [4]

4 From orbits to various types of immersions

4.1 Preamble

In this section we examine the effect of three involutive transformations on orbits of bicoloured
immersions: the colour swapping or swap in short, denoted by s; the mirror transformation, m;
and the orientation reversal r. These three involutions commute. Their explicit form depends on
the class of orbits on which they act, as we shall see below. Given an orbit o belonging to a set O
and an involution J, if oy denotes the transform of o under J, there are two cases: either o = o7, or
o # oy, a truism !, and we define

rrp =#{o€ Olo=or}, sr = #{{o,o7}|0 Z o7} (12)

15
/n/n(i.e., , $7 = # unordered pairs of distinct 0,07). In the case of two commuting involutions J and J,
there are five cases:

1) o=o0; =0;=07, 2) o=o0; #0; =oO7,7,
3) o=0; #0; =077, 4) o=or7 #07 =07,
5) 0,07,07, 077 all distinct ,

and we call

try =X H#{o € Olo = of = 07 = o7s}
YII #{{o,0;}|o = of #07 = O77}
Z1J =YdL #-{{o,01}|o = 07 # of = ors} (13)
Vly =VUII #-{{o,01}|o = or 4 07 = OF}
wry=wsr = #{{0,07,07,0r7}\0, 07,07, 077 all distinct}

For J and J standing for the mirror and the orientation reversal, those are the five cases discussed

by Arnold [2]. We note that the relation between and is
rps=aryt+ Qi, sr as+vis+ Qwiy.

For three involutions, there would be 15 cases (in general, the number of cases is given by a Bell
number) but we shall refrain from listing them here.

4.2 The swap image of a map

We first examine the effect of (colour) swapping (or equivalently, of interchanging all overcrossings
and undercrossings in a knot diagram). Consider a bicoloured curve described by some o € Y’ and
its (colour) swap described by os. What is the relation between o and o,? Let p be fixed equal to
py as above, T = apo and f = oppo !. Then swapping colours implies to exchange p and /, and
a and t~!, but also to change the labelling of edges in such a way that f takes the form po. A
permutation 7 that carries over that change of labelling must satisfy

p= poo! = 7 "poy,

the general solution of which is y = 7/o~! with 7 € Cy. Up to Cp-equivalence we may just choose
y= o7!. Then after conjugation by 7,

G5 = yt yt = appt! = yor" yopoo7 yt
= yor'y yp = 70 "y"po, (14)
which for the above choice y = a! reduces to
—,l _
Os =O po = > os = po. (15)

Hence the coloured curve (or the alternating knot diagram) and its swapped version are described
by o and o, =a~‘py. We refer to the C,-orbits of o and o, as swapped orbits o and 0g.

If n is odd, the signature of po, a product of an odd number of transpositions, is —1, and 0
and o, = 0~!po cannot be conjugate in Son, and a fortiori cannot belong to the same orbit under
the action of Cp: o ~ os, where ~ and its negate ~ refer to conjugacy with respect to the group
C,. Another argument is that 0 ~ 0, would imply that the numbers of white and shaded faces are
equal, hence # faces is even, in contradiction with Euler formula for n odd.

In general, using the terminology of (12), for given n and genus g, let r, be the number of
self-swapped orbits, i.e., such that o = os, and ss be the number of pairs of non self-swapped orbits

16
/n/n{o, os}, ie., such that o 4 og. Thus r, = 0 for n odd and all genera, while for example, in genus 0,
we find

n=2 rg=l1 S,=
n=4 rs =5 s,= 16
n=6 rs=33 8, = 555 (16)
n=8 rs=249 s,= 27155
n=10 rs = 2036 ss = 1624602.

For any genus g, the number of Y; orbits, i.e., of bicoloured UO curves of genus g is thus given
by rs + 28s, while those in which we ‘dentify the two colours, namely the bicolourable UO curves,
have a cardinality equal to r, + s,. As we discussed already, for g = 0, bicolourability is not a
constraint, and we recover the number of UO curves found in Sect. 2} while for g > 0, the UOc
bicolourable curves are a subset of the UO curves, see below Sect. [4.4] for a general discussion.

4.3. Mirror image of a map
On maps/orbits of Yy we may also define a mirror transformation. The latter swaps o and 7, hence,
if p = po is fixed, changes o into opp. Maps are either “achiral”, if o and om := apo belong to
the same orbit, and we write o = 0, or appear in chiral pairs {7,0}, when om, ~ 0, or 0 F Om.
Again, for n odd, as po has an odd signature, o and om cannot belong to the same orbit.

In general, for given n and genus g, let 7, be the number of achiral orbits, i-e., such that 0 = om,
and sm be the number of chiral pairs of orbits {0,0m}, 0m # 0. Thus rm = 0 for n odd and all
genera, while for example, in genus 0, we find

n=2 ttTm=1 S8m=1
n=4 Tm=5 sSm=16
n=6 Tm=15 $m = 564 (17)
N=8 m= 97 8m = 27231
n=10 Tm =592 Sm = 1625324.

The number of orbits in Y}; ie., of bicoloured UOc curves of genus g is thus given by rm + 25m,
while those in which we identify the ‘two mirror images, i.e., the two orientations of the target surface,
dubbed UUc, have a cardinality equal to rm + 5m, see below Sect. [4.4] [4.4] for a general discussion.

4.4 Discrete operations on UOc immersions: from UOc to UOb, UUc and UUb

Following the discussion of Sect. we may analyse the interplay between swap and mirror
transformations on Cp-orbits of Yj; (UOc immersions) by introducing

Lsm = #{orbits o| o = 0, = Om = Osm} , i.e
= #{orbits that are both achiral and self-swapped},
Ysm = ##{unordered pairs {0, 0m}|o = 0s 4 Om = Osm} , ie
= #({chiral pairs of self-swapped orbits},
Zsm = #{unordered pairs {0,05} |0 = 0m 4 Os = Osm} ,1.€
= #({swap pairs of achiral orbits},
Usm = #{unordered pairs {0,05} | 0 4 05, 0 = Osm and 0; = Om},

Wsm = #{4-plets of orbits {0, 05, 0m, 0sm} |0,0s,0m; sm all distinct},

17
/n/nhence

Ps = Lsm + 2Ysm
Ss Zsm + Usm + 2Wsm
™ = Lsm + 2Zsm
Sm Ysm + Usm + 2Wsm
In particular for n odd, the vanishing of r, and r,, implies gm = Ysm = Zsm = 0.

The five independent quantities @5m, Ysm; Zsm; Usm; Wsm Must be determined in each Y;; their
values are gathered in Appendix B.1. Then counting how many times each class of orbits contributes
to each type of immersions, one obtains, for every genus:

|UOc| Ts +285 =Tm + 25m = Lam + 2Ysm + 22%sm + 2Vsm + 4Wsm

|UOb| Ts +83 = Lsm + 2Ysm + Zsm + Usm + 2Wsm

|UUe| Tm + 8m = sm + Ysm + 22m + Vsm + 2Wsm (18)
|UUb] = Lem + Ysm + Zsm + Vem + Wsm

For example in genus 0, and for n = 1,...,10, we obtain:

Unoriented S! in unoriented S? :

19
#UU immersions = 1, 2,6, 19, 76,376, 2194, 14614, 106 421, 823 832 (19)

thus extending the OEIS sequence A008989 [4] and Valette’s recent results [IJ].
From the values given in Appendix B.1 we see that %gm = Ysm = Zsm = 0 for odd g, an empirical
observation for which we have no explanation yet.

4.5 Discrete operations on OOc immersions: from OOc to OOb, UOc, UOb,
OUc and OUb

The previous discussion, that was applied to the set Y’ and its Cp orbits (or, equivalently, to the
set U and its D,-orbits) of type UOc may be applied to the set U of Sect. [3.2] and its Zp-orbits of
type OOc.

Proposition 2. For o belonging to some Z,,-orbit of U

(i) o + o, := ror belongs to the reversed orbit, with r = [2n,2n —1,--- ,2,1], (remember that
r=);
(ti) 0} Om :=T = ap belongs to the mirror image of the orbit.

(iti) 0 Ho, := B-'7'B = B-'po!B belongs to the swap orbit, with B the cyclic permutation
(1,2,--- ,2n) as above.

(iv) 0 + Opm := rTr = rorp belongs to the reversed mirror orbit, and likewise for the other
compositions of the commuting involutions s,r,m.

Proof. In each case, it is clear that the transform of o carries out the required transformation. The
important point is that if 7 belongs to U, i.e., satisfies (8). so do 0;,0m and os. This is obvious for
Om; it follows from the identities rpr = p for o, and ragr = ao for o,; and from Bo! pp = ag for
os, if one remembers that o = &, € € C,:

ospo,'p = B~'po~'BpBopBp = B~' p&|pEpBp = B-' pBp = a9.

18
/n/nNow define once again along the lines of

Lop #{Z,—orbits olo = 0, = 0, = Os}

Ysr = #{pairs {0,0,}|o = 0, F 0, = Og}

Zsr = #{pairs {0,0,}|0 = 0, # Os = Os} (20)
Usr = #{pairs {0, 05}|0 = Osr F Os = 0, }

Wsr = ##{quadruplets (0, 0;,0;,05), all non equal}

Their values are gathered in Appendix B.2.

Then
JOOc| = asp + 2Ysr + 2Zsr + Wer + 4Wsr
JOOb] = wer + 2ysr + Zr + Usr + 2Wer
|UOc] = &sr + Ysr + 2Zsr + Vsr + 2Wer (21)
{UO >| = Usp + Ysr + 2sr + Usr + Wsr

A similar discussion can be carried out on the action of the involutions s and m on the orbits of
OOc, expressing |OOc}, |OOb|, |OUc| and |OUb| in terms of new numbers gm, Ysm; Zsm; Usm; wen}

The values of these five parameters are gathered in Appendix B.3. Then
|OOc| Lem + 2Ysm + 2Zsm + 2Vsm + 4Wsm
| OOb| Lsm + 2Ysm + 2Zsm + Usm + 2Wsm
|OUe| Lsm + Ysm + 225m + Usm + 2Wsm (22)
| OUb| XLsm Ysm Zsm + Usm + Wsm

From the values given in Appendix B.2 and Appendix B.3, one observes that 2s, Zsm; Ysr and
Ysm vanish for all (n,g), meaning that o ~ o, never occurs. Moreover, for n even, Zsr = Usm = 0,
and for n odd, Zsm = Usr = 0. Those are general features:

Proposition 3. If ~ means the equivalence with respect to the adjoint action of Zn,

(i) for any n and g, #{o € Ula ~ a5} =0, hence sr = Ysr = Lsm = Ysm = 0;

(ti) for any even n and any genus g, #{o € U|o ~ o,} = 0, hence zs, = 0; and #{o € Ula ~
osm} =0, hence vsm = 0.

(tii) for any odd n and any genus, #{o0 € Ula ~ om} = 0, hence zsm = 0; and #{o € Ula ~
Osr} =0, hence vs, = 0.

Proof. First, one notices that o ~ ag is certainly true for n odd, see Sect. We thus turn to
n even. We write o = G€ as in Prop. [i] and note that §? is a generator of the Z, group and that
p, 6? and € are in the centralizer Cy. By the homomorphism ¢ introduced in Sect. [3.1] p is mapped
o the identity permutation of S,, and ? to the cyclic permutation (1,2,--- ,n), which is odd for
n even. Then

i) o~ os = Bo'718 = Bp! means Jp € {0,---,n—1} st. B??(BE)B-?? = BpE, or
B2P+2¢3-2P — pé—!. If we take the image of both sides by ¢, the signature of the lhs is minus the
signature of ¢(€) while the rhs has the signature of ¢(€). There is a contradiction, q.e.d.

ii) Suppose likewise that ¢ ~ 0, = ror = 6??(B€)8-??. Conjugation of a permutation by r shifts
he labels by —1 and reverses its cycles; in particular r8r = 8—'. Thus the images of rér and €
oy @ have the same signature. Notice that ror = rBér = (rBr)(rér), using the fact that r? = 1,
so that o = 8~'rér. Supposing that o and o; are Zn-conjugates therefore amounts to supposing

°By “new”, we mean that they are relative to the OOc orbits and that their values differ from those defined and
isted below in App. B.1.

19
/n/nthat rér is conjugate with 6??+?¢38-2? = 6?.6?PE8-2P, However the image of 6? by ¢ is odd for n
even. This contradiction completes the proof of the first part of (ii). For the second part, osm Bg oO,
ie., O5m = B-1E7+ 2 BP+1eB-2P it leads to €~? 2 6? again in contradiction with signatures for n
even, q.e.d.

(iii) is again a trivial consequence of the parity of permutations: for n odd, ¢ ~ om = op, or
o~ Osr =7r8-po-Br-" are impossible, since p is odd.

Theorem 4. For any genus g,

OOc| = 2|OOb| for any n (23)
UOd = |OOb| if neven (24)
2|UOb|_ if n odd
OUd) = 2|OUb| if neven (25)
|OOb| if n odd
UUd = |OUb| if n even (26)
|UOb| if n odd
Proof. Those are consequences of relations and of Proposi ion {3} (23) follows from 2s = Ysr =

0; follows from zs, = 0 for n even and from vs, = 0 for n odd. For (25), we perform a similar
analysis relating the sets OOc, OOb, OUc, OUb: one finds that

2|OUb| — |OUc| = Usm = #{pairs {0,05}|0 = Osm 4 Os}

which vanishes for n even, according to Prop. [3] (ii), and that

|OUc| — |OOb| = zsm = #{pairs {0, 05}|0 = Om # os}

which vanishes for n odd, according to Prop. |3} (iii).

Finally may be derived from the same analysis for the sets OUc, OUb, UUc and UUb: one
finds that

|OUb| — |UUc| = #{o € OUclo = 0, }

which vanishes for n even; for the second relation (26) one may appeal to (18) together with
Lsm = Ysm = Zsm = 0 for n odd.

Remark. Recall that for genus 0, |OOb| = |OO] and thus, from Theorem 4, we have |UOc| =
|OO| if n is even, and |UOc| = 2|UO| if n is odd.

Note that as a by-product of this discussion, we have obtained now the number of spherical
(g = 0) immersions of types OO and OU,

Oriented S$! in oriented S? :

27
#00 immersions = 1,3, 9,37, 182, 1143, 7553, 54559, 412 306, 3 251 240,--- (27)

Oriented S! in unoriented S? :

28
#OU immersions = 1,2, 6,21, 97,579, 3812, 27328, 206 410, 1625 916,--- (28)

thus extending the OEIS sequences A008986, A008988 [4] and Valette’s recent results [IJ].

20
/n/n5 Immersions of types OO, UO, UO and UU from cyclic permu-
tations of 5»,

5.1 The subset Z’ = [2n] of Z = 5), and its orbits for the adjoint action of a
particular S,, subgroup (“Z method”)

In the present section, we shall count the number of orbits in a particular conjugacy class of
Z = Son, namely the set Z’ of its cyclic permutations, under the action of a particular subgroup Cc
isomorphic with S,,. Our goal is to determine the numbers of immersions of a circle in a Riemann
surface of given genus, irrespective of the bicolourability condition that we introduced in
he previous section. To achieve this, we first consider an oriented circle and make use of another
abelling of maps by permutations of Son.

The “Z method”. Consider a map, the edges of which are oriented in a consistent way for
our purpose, namely with incoming edges at each vertex next to one another, see Fig. Let us
abel the edges of such a map by an index 7 running from 1 to 2n. At each vertex, there is an
involution p € [2”] C S2n which exchanges the labels of the two incoming edges, and a permutation
am that yields the labels of the outgoing edges, see Fig. The condition that the map has a
single component amounts to saying that m has a single cycle, 7 € [2n]. As before, we can fix p,
for example to be equal to po = (1, 2)(3,4)---(2n — 1, 2n), a product of n disjoint transpositions.
With that convention, the integers (2a — 1,2a), a= 1,---n, label the a-th pair of incoming edges,
ordered, say, in a clockwise way. Then the number of topologically inequivalent oriented maps
equals the number of orbits of Z’ = [2n] under the conjugate action of a subgroup of S2n, made of
permutations that map odd (resp. even) labels onto odd (even) labels and commute with po. As
it consists of permutations of the n pairs (2a — 1, 2a), a = 1,2,--- ,n, it is isomorphic with S,, and
1as order n!. We shall usually denote it by Ch

el. (i) 2a m(2a-1)

Figure 11: Above, left : labelling oriented edges; right: special choice of p. Below, defining the
new labelling of edges: in red the original labelling from 1 to 2n, in blue the new one
from 1 to 4n.

21
/n/nIn order to study the genus of the corresponding map, we now associate with the permutation
m € Soy another permutation a, € San. The idea is to duplicate the edge labels so as to label
separately the left and the right sides of each edge (or in the fat graph picture [28], to label inde-
pendently each of the double lines): we choose to label the right side of the oriented edge originally
labelled by 7 € {1,2n} by i, and its left side by i + 2n, see Fig. [11] bottom for an illustration. The
permutation w, then describes the succession of these labels as each face is travelled clockwise.
The transformation 7 ++ w, (not a group homomorphism) is easily implemented, for 1 <i < 2n,

(i) m(i+1) if 7 is odd,
U_r(i) =
m i—1+2n if dis even

(29)

Up(it2n) = fat +1+4+2n if 11(4) is odd

m(x—*(i) — 1) if 7 ~!(i) is even

Example of encoding. As an example, the bottom diagram of Fig. [Idjis encoded by permuta-
tions

x = [2,7,5,1,6,9,8,3, 10, 4] = (1,2,7,8,3,5,6,9, 10, 4)
Un = [7,11,1,13,9,15,3,17,4, 19,5, 12,8, 10, 14, 16, 2, 18, 6, 20] (30)
= (1,7,3)(2,11,5,9,4, 13, 8, 17)(6, 15, 14, 10, 19)(12)(16)(18)(20) .

The genus of the map is then given by the Euler characteristics,
Cir) =n+2—2g. (31)

Filtering the set Z’ = [2n], resp. its orbits under the action of C,, with that criterion yields the sets
Z;, tesp. their orbits; the number of orbits of Z” := Z@ is the number of immersions of an oriented
circle in the oriented sphere.

Theorem 5. Call p = (1,2)(3,4)...(2n— 3, 2n —2)(2n—1, 2n) € [2"] C Son, using cycle notation,
and Ch, the subgroup of Z = Son, isomorphic with S,,, that commutes with p and permutes odd resp.
even integers among themselves. Circle immersions of the oriented circle in an oriented surface of
genus g, or OO immersions for short, are in bijection with the orbits of Ci, acting by conjugacy on
the set of permutations x that belong to Z' = [2n], the subset of cyclic permutations of Z, and such
that the associated permutation Wr € San, defined previously, satisfies the condition

Cir) =n+2—- 29, (32)
c(x) being the function that gives the number of cycles (including singletons) of the permutation x.

Remarks.

The group C/,, isomorphic with S;,, is contained in the centralizer C, of p in Sgn. It is generated
by the pairs of transpositions (1, 3)(2, 4), (1,5)(2,6), (1,7)(2,8), ..., (1,2n — 1)(2,2n). Notice that
C(Son,Cp) = {1,p}. One can see that Ci, is precisely the subgroup S,, of Sj, that allows one to
build the subgroup C, used in the previous two sections as a wreath product (see the comments in
Sect. [3.1).

As already mentioned in the introduction, the 4-valent maps that we consider also define cellular
embeddings of particular graphs called “simple assembly graphs without endpoints” in [9]. In this
reference the authors introduce the notion of genus range of a given graph (the set of all possible
genera of surfaces in which the graph can be embedded cellularly), a notion that is also studied
and generalized in Their work uses the same ribbon (or fat) graph construction as ours,

"We thank an anonymous referee for pointing out these two references.

22
/n/na construction that was described in a quantum field theory context [28], and in [5] as a tool for
classification of immersed curves; their encoding of maps use chord diagrams and Gauss codes. In
contrast, the methods presented in this section do not use chord diagrams but introduce a way to
encode the relevant graphs (and their fat partners) in terms of permutations and relate systems of
representatives for different types of immersions to double cosets of appropriate finite groups (see
below).

From cyclic permutations on 2n elements to simple closed curves with n crossings
in Riemann surfaces. We described how to associate a cyclic permutation to the image of an

immersion in an oriented Riemann surface of genus g, more precisely to a closed curve, drawn in
1e plane, with n regular crossings, and some number of virtual crossings. Conversely, associating
a closed simple curve with a given cyclic permutation 7 belonging to 52, is straightforward. One
draws n four-valent vertices : four half-edges at each vertex, two ingoing, two outgoing, obeying
the usual transversality (crossing) condition. If j is odd, 7(j) labels an in-going half-edge, 7(j) +1
labels the in-going half-edge at the same vertex and located immediately to the right of the previous
half-edge (using a clockwise orientation), 7(j + 1) labels the outgoing half-edge corresponding to
m(j), and 7(m(j) + 1) the outgoing half-edge corresponding to 7(j) +1. One starts with j = 1 and
obtains in this way the four half-edges associated with some vertex. One then considers, in turns,

ct

j = 3, j = 5, etc, and the construction terminates since there is a finite number n of vertices.
The last operation is to connect the half-edges carrying the same labels. Of course, the obtained
closed curve, drawn on a plane, will have usually more that n crossings, but only n of them — those
defined by the permutation 7 — should be consider as regular crossings (the others being virtual).
The genus is determined by considering the associated fat graph, i.e., the permutation ~(7), and
using the Euler formula. The fact that the obtained curve indeed corresponds to the image of an
immersion is taken care of by the necessity of choosing the possibly non-zero genus determined by

5.2 A partition of Z’

In order to get representatives, for each genus, of the orbits of Z’, one may first determine the
orbits, and then filter them according to the genus, this is what we shall actually do. However
one can also start by partitioning the set Z’ according to the genus (sets Z}) and determine the
orbits, for each g, in a second step. This latter method is, in practice, slower than the first. It
produces as a by-product, and for each positive integer n, a family of numbers |Z; that add up to
(2n — 1)! since this is the cardinality of Z’ = [2n]. The same numbers could also be obtained with
the first method, proceeding backwards, by using the orbit-stabilizer theorem for each orbit of Z;:
These integers are gathered, for the first values of n, in Table [12] Notice that each member of the
above partition can itself be decomposed into strata corresponding to different sizes of the orbits:
for instance, taking n = 5, one gets 21552 orbits corresponding to the union of 21480 and 72 orbits
with respective centralizers of order 1 and 5. We shall not display that information.

5.3 Counting orbits and their lengths

In order to obtain the genus decomposition for the various kinds of immersions we are interested
in (OO, UO, OU and UU types), one has to use explicit cyclic permutations for these different
kinds of immersions, together with the method (filtering by genus) previously described in Sect.
[5.1] for OO immersions. We shall see later, in [5.5] how the introduction of discrete transformations
(orientation reversal and mirror symmetry) on OO orbits allows us to refine the method and obtain
the numbers of immersions for the types OU, UO and UU. The appearance of non-trivial stabilizers
complicates the counting of orbits: in practice, one possibility is to select a random permutation o
from the given set (Z’), determine its conjugates, see whether or not one of them has already been

23
/n/n42 66 12
780 2652 1608
21552 132240 183168 25920
803760 7984320 20815440 10313280

Figure 12: Numbers of elements in the sets Zh. Each line adds up to an odd factorial.

selected, take the decision about keeping o, or not, throw away its conjugates, and start again (a
similar method amounts to implementing an appropriate variant of the Jeu de Taquin). Initially,
this is what the authors did. However, the problem of selecting one representative for each orbit
is simply related to a similar problem for double cosets, and one can take advantage of the fact
that several computer algebra programs (in particular Magma, see our comments in Appendix A),
provide fast algorithms to determine such representatives. This other approach allowed the authors
to recover and extend their previous results. The relation between the two problems is summarized
in the following proposition:

Proposition 4. For each type OO, UO, OU, or UU, of immersions of the circle, a system of
representatives for the orbits of the subgroup Ci, ~ S, acting by conjugation on the set of cyclic
permutations [2n], is given by the elements of the seB { B/* }, with « € H\G/K, where 8 =
(1,2,3,...,2n), where the subgroups H and K of G = Sop, are as indicated below, and where it is
understood that we choose one representative element x (a permutation) in each double coset.

e For OO, one takes H = Zg, the centralizer of the cyclic permutation B in G, and K = Ch.

e For UO, one takes H =< Zg,0,>, the subgroup of So generated by Zg and the permutation
(2, 2n)(3, 2n — 1)(4,2n — 2)... (n,n +2) that conjugates 8 and B~! in Son and implements
orientation reversal of the source (circle), and K = Ci.

e For OU, one takes H = Zg and K =< Ch. p>, the subgroup of Son generated by on and the
permutation p which describes mirroring in the target, see Sect.

e For UU, one takes H =< Zg,0,> and K =< Ch p>.

The proof of this proposition, in the OO case, relies on Theorem We already know that
he orbits for the adjoint action of K on the conjugacy class of 3 (the cyclic permutations) are in
one-to-one correspondence with the double cosets of H\G/K. The above proposition makes this
correspondence explicit in the present situation: taking x and 2’ in the same double coset, we write
x’ = hak, with h ¢ H = Zg and kk € K = C7, and see immediately that Bi — p-1 BV" k, g0
he two permutations BY and BY ® which are cyclic since both conjugated of 6 — which is cyclic
itself — by an element of G, are also conjugated by K and therefore characterize the same OO orbit.
The justification for the choice of the other subgroups, appropriate to handle the immersions of
ypes OU, UO and UU, ultimately relies on a discussion that will be carried out in the next section

discrete transformations).

’There are two possible conventions for the product of two permutations. In this paper we use the right-to-left
product, which is not the convention used in [29] or [30]. Also, 8” = y8y~'. With the other convention, one should
replace 1/a = a! by a in the next formula, or replace the pair (H, K) by (K, H).

24
/n/nNotice that if one is interested only in counting the total number of immersions, i.e., summing
over all genera for each of the types OO, OU, UO and UU, one does not need to determine double
coset representatives since only the total number of double cosets matters. The latter can be
computed up to large values of n by using Frobenius’ formula (2) — we remind the reader that it
uses only the knowledge of the cyclic structure and size for the usual conjugacy classes: this is both
simpler and faster. The results for OO, i-e., the number of orbits in Z’ are displayed in Table
up to n = 20. The corresponding results for types OU, UO, UU, can also be determined) by using
Frobenius’ formula in virtually no time up to n = 20, those up to n = 10, are given in Table [8]

The drawback of this last method is that it is not constructive, so that one has to rely on the
previous approaches (brute force determination of the orbits or use of double coset representatives)
to go to the next step: filtering according to the genus. Actually, this last part is the bottleneck of

the process as the function w, defined in the previous section takes its values in Sy.
Table 4: Number of orbits in Z’ (OO case)

1 1 1 1279 935 820 810

2 4 2 53 970 628 896 500

3 22 3 2 490 952 020 480 012

4 218 4 124 903 451 391 713 412

5 3028 5 6 761 440 164 391 403 896

6 55540 6 393 008 709 559 373 134 184

7 1235 526 7 24 412 776 311 194 951 680016

8 32 434 108 8 1613 955 767 240 361 647 220 648

9 980 179 566 9 113 146 793 787 569 865 523 200018

10 | 33522177088 |} 20 | 8384177 419 658 944 198 600 637 096
For n a prime integer, we found an explicit formula for this number of orbits.

Proposition 5. For n a prime integer,

(2n — 1)!

#orbits in Z’=n—1+ 1
nl

(33)
Proof. For any n, orbits of Z' have length |C/|/d with d a divisor of n, and we claim there are
exactly n orbits of length |C5|/n. The diagrams of these orbits have cyclic n-fold symmetry. At the
possible price of introducing “virtual crossings”, (see Introduction), these diagrams may always be
drawn in the plane in such a way that the outmost edges form a convex regular n-gon, travelled
in the clockwise or counter-clockwise way, with vertices numbered from 1 to n, and with one
pair of oriented edges connecting vertices i and i+ 1, and the other pair i and i+k mod n, for
k =0,1,---n—2 (k =n-—1 yields a n-component diagram).

C369 - OOS

Figure 13: The n = 5 orbits of Z’ with 5-fold symmetry. Only the first three (in red) are spherical,
the two others have higher genus (2 here); the last three are equivalent to (i.e., in the
same orbit as) their reversed; in the last two, only the outmost vertices are double
points, the others are “virtual crossings” as explained in the Introduction.

® They have been added to the OEIS: OO A260296, UU A260912, UO A260847, OU A260887.

25
/n/na3 G8 3 O GO B

Figure 14: The n = 7 orbits of Z’ with symmetry of order 7. Only the first three (in red) are
spherical, the others have higher genus (3 here).

5.4 From orbits of Z” to spherical immersions of type OO

According to Theorem [5] the numbers of spherical immersions of type OO may be determined from
the numbers of orbits of Z” = Zj and agree with those computed above in (27). They also appear
in Table B] The numbers in red are still to be double-checked. . .

5.5 Discrete transformations of OO immersions. Immersions of OU, UO and
UU types

We now consider the effect of the discrete transformations r and m on immersions of OO type.

Orientation reversal. Consider the effect of changing the orientation of the circle: it simply
corresponds to 7 +4 1~!. Orbits of Z’ (for a given genus, in particular those of Z””) split into two
classes: those for which 7 and 1~! belong to the same orbit may be called reversible immersions;
the others form pairs of irreversible immersions.

Mirror symmetry. If some immersion is described (for p fixed as above) by (the orbit of) some
7, its mirror image is associated with the orbit of 7’ = pp. We call again achiral the immersions
such that 7 and 7’ = prp belong to the same orbit, while the other form chiral pairs.

The five types of symmetries. o being an orbit of Z’ (of given genus), we call e o, the
orientation reversal image of 0,
© Om the chiral image of 0,
© Orm the chiral image of the orientation reversal image of o (or the other way around).

By combining the two previous transformations, we thus find five types of immersions that
match Arnold’s classification of symmetries [2]. Following our notations of Sect. we call
Lrm; Yrm; Zrm; Vrm; Wrm their numbers of elements:

Or = Om = Orm}

= number of orbits that are both achiral and reversible.

Irm {orbits | 0

Yrm = ##{orbit pairs {0, om} |o = or,0m = Orm}

= number of chiral pairs of reversible orbits.
Zrm = #{orbit pairs {0, 0,} | 0 = Om, or = Orm}

= number of irreversible pairs of achiral orbits.

Urm = ##{orbit pairs {0,0;}| 0 4 0, but such that 0 = 0pm & or = Om}.

Wrm = #{4plets of orbits {0, 0;,0m, orm},

where all members of each 4-plet should be distinct.

The values of those five parameters are gathered in Appendix B.4, and one obtains, for every

26
/n/ngenus:

|OO| 2Yrm + 22pm + Wem + 4pm
|UO 2Yrm + Zrm + Vem + 2Wem
|OU| Yr + 2pm + Vem + 2Wem (34)
|UU| Yrm + Zrm + Urm + Wrm -
In that way, we recover the number of immersions for g = 0 found in Sect. |4| which yields a

non-trivial check on both methods.

From Theorem 4 (eq. (26)) one shows that, for g = 0 and n odd, Usm = Lpm + Zrm + Urm
and Wsm = Yrm + Wrm, the Vsm and Wsm parameters being those defined in Sect.
Appendix B1 (not B3 !); remember also that tym = Ysm = Zsm = 0 in that case. For g = 0
and n even, we notice a one-to-one equality between the same 5-plet (sm, Ysm;Zsm;Usm; Wsm) and
(Lrm;Yrm; Zrm; Urm; Wrm), but this is only an observation for which we have no explanation, and it
suggests a direct correspondence between the corresponding orbit types.

see also

6 Miscellaneous comments

6.1 Asymptotics

The number of points in the three sets X’, Y’, U or Z’ are known explicitly and grow factorially

|X/| = (4n—2)!!
\Yi| = 2"-lnl(n—1)! (35)
|Un| = 2"n!
[Z,| = (2n—-1)!
Then, using the classical fact that “almost all maps are asymmetric” [15], the asymptotic numbers
of orbits in X’, Y’ or Z’ are given by
ey (4n— 2)!  1(2n—1)! Pn}
#C,—orbits in X), Pal IW n! POP
#C,—orbits in Yf ~ #D,—orbits in U, ~ 2”-!(n— 1)! (36)
#Z, orbits in U, ~ 2"(n—1)!
2n — 1)!
#C,—orbits in Zj, ~ (n—1)! ~ 2#C,—orbits in X/,
nl

Unfortunately we have no similar exact formulae for orbits in X”, Y” or Z”, and we have to appeal
to empirical estimates derived by physicists in similar contexts, see for example [25]. For each of
the above quantities, one expects an exponential growth of the form

#n ~ Kn? a” (37)
with a, y the “string susceptibility” and & some constant, depending on the problem at hand.
Here, according to Schaeffer and Zinn-Justin|22], y = — ESAER corresponding to a central charge

c=-—1 in KPZ formula
c—1-—/(25—e)(1—c)

7} (38)

yKez(c) =

(see for instance [25], eq. (4.2)).

27
/n/nIn genus g, one expects 7 in asymptotic behavior to be replaced by
719) = (b= 9)7 (39)

(which makes the “double scaling limit” possible). Unfortunately, the order n = 10 that we have
reached is certainly much too low to enable one to observe the onset of this asymptotic behavior.
See for a discussion of the logarithmic corrections to that asymptotic behavior.

6.2 Knot census

Applying the previous counting of maps to the census of (alternating) knots requires eliminating var-
ious types of redundancies, kinks aka nugatory crossings, non prime and flype equivalent diagrams,
following Sundberg and Thistlethwaite’s procedure [26]. See [27] for a beautiful implementation
including virtual knots and links.

7 Results and conclusion

Our results on the numbers of curves of different types and different genera are gathered in Tables
(bicolourable and/or bicoloured immersions) and |8| (general immersions). Subtables of Table [9
can all be obtained from the U method, and also from the Y method for cases UOc, UOb, UUc
and UUb. Subtables of genus 0 are also obtained from the X method. Subtables of Table [8] are
obtained from the Z method. Subtable UO is also obtained from the X method. The reader will
verify the various identities stated in Theorem [4] between numbers of different types of immersions.

As the case of immersions of a circle in the sphere is of particular interest, we summarize their
numbers in the following tables. Recall that in that case (genus 0), there is no distinction between
bicolourable and general immersions. As the vast majority of immersion diagrams contain a “simple
loop” (aka “kink”, see for example all the diagrams in Fig. ii), it is suggested to discard them and to
count only diagrams without such simple loops. In a next step, one may concentrate on diagrams
that are irreducible and indecomposable, i.e., not made disconnected by removal of a vertex, resp.
by cutting two distinct ine™|

In the formalism of Sect. |3} no simple loop means that neither o nor tT = op has a cycle of
length 1. Imposing indecomposability and irreducibility requires a more detailed analysis, incorpo-
rated in a Mathematica codd]

Table 5: Counting of spherical immersions

n 1/2) 3] 4 5 6 7 8 9 10
0O 1) 3] 9 | 37 | 182 | 1143 | 7553 | 54559 | 412306 | 3251 240
UO 1) 2] 6 | 21] 99 | 588 | 3829 | 27404 | 206543 | 1626638
OU 1) 2] 6 | 21] 97 | 579 | 3812 | 27328 | 206410 | 1625916
UU 1/2] 6 | 19] 76 | 376 | 2194 | 14614 | 106421 | 823832
UOc |) 2 | 3 | 12 | 37 | 198 | 1143 | 7658 | 54559 | 413086 | 3251240

10In the knot theory terminology, diagrams with a simple loop or reducible are referred as having a “nugatory”
crossing, and indecomposable ones as “prime”.

‘The numbers for OU and UU irreducible and indecomposable immersions (Table [7p have already appeared in
the literature, actually up to n = 11 crossings, see OEIS sequences A089752 and A007756 and [23]. After completion
of the first version of the present work, we learnt from Bétréma that he had been able to compute the numbers of
OO, OU and UU irreducible and indecomposable immersions up to n = 14 [36].

28
/n/nTable 6: Counting of s

pherical

immersions with no simple loop

n 1)/2)/3)4)5)/6)] 7 8 9 10
OO immersions 0/0/1)1)2)9 | 29 | 133 | 594 | 2864
UO immersions 0/0/1)1/2)6)19) 74 | 320) 1469
OU immersions 0/0/1)1)/2)5]18) 70 | 313 ) 1440
UU immersions 0;O;1)1)2)5) 16} 52 | 205) 863
bicoloured UO immersions || 0 | 0 | 2 | 1 | 4 | 9 | 38 | 133 | 640 | 2864

Table 7: Counting of irreducib:

e indecom

posable spherical immersions.

n 1}/2])/3/4)/5/6] 7] 8 9 10
OO immersions 0};0);1)1)24)6) 17 | 73) 290 | 1274
UO immersions O0;O0);1)1)2)4) 12 | 41) 161) 658
OU immersions 0/0)1)1)2) 3411) 38) 156 | 638
UU immersions 0;0);1)1)243) 10} 27) 101 | 364
yicoloured UO immersions | 0 | 0) 2] 1) 4 | 6) 24 | 73 | 322 | 1274
Table 8: Counting of general immersions of a circle in a surface of arbitrary genus g, up to stab.
geotopy. U = Unoriented, O=Oriented. Figures in red should be confirmed.
n 1,2] 3 4 5 6 7 8 9 10
OO, total 1 | 4 | 22 | 218 | 3028 | 55540 | 1235526 | 32434108 | 980179566 | 33 522 177088
[00,g=0][1[3[ 9 | 37 | 182 | 1143 | 7553 | 54559 [412306 [3251240 |
00, 9g = 0} 1) 11 | 113 | 1102 |) 11114 112 846 1160532 12038 974
OO, g = 0/0) 2 68 | 1528 | 28947 | 491767 7798139 | 117668914
OO, g = 0/0) 0 0 216 | 14336 | 554096 | 16354210 | 407921820
OO, g = 0/0] 0 0 0 0 69 264 7066668 | 397094352
00,g=5 || 0 | 0] 0 0 0 0 0 0 45 043 200
UO, total 1 | 3 | 13 | 121 | 1538 | 28010 | 618243 | 16223774 | 490103223 | 16761330464
[UO,g=0 || 1] 2] 6 | 21 | 99 | 588 | 3829 | 27404 | 206543 | 1626638
UO, g = oO; 1) 6 64 559 5656 56 528 581511 6 020 787
U0O,g=2/,0)0] 1 36 772 | 14544 | 246092 3 900 698 58 838 383
UO, g=3 || 0| 0) 0 0 108 7222 277114 8180123 | 203964 446
UO,g=4 || 0] 0] 0 0 0 0 34.680 3534038 | 198551464
UO,g=5 |] 0] 0] 0 0 0 0 0 0 22521 600
OU, total 1 | 3] 14 | 120 | 1556 | 27974 | 618824 | 16223180 | 490127050 | 16761331644
[OU,g=0 |] 1/2] 6 | 21 | 97 | 579 | 3812 | 27328 | 206410 | 1625916
OU,g=1 || 0/1] 6 62 559 5614 56 526 580 860 6 020 736
OU,g=2 || 0/0] 2 37 788 | 14558 | 246331 3900 740 58 842 028
OU, g=3 || 0 | 0] 0 0 112 | 7223 | 277407 | 8179658 | 203974134
OU g=4 |/ 0] 0] 0 0 0 0 34748 3534594 | 198559566
OU,g=5 || 0] 0] 0 0 0 0 0 0 22524176
UU, total 1] 3] 12) 86 894 | 14715 | 313364 8139398 | 245237925 8 382 002 270
[UU,9=0 [1/2] 6 | 19 | 76 | 376 | 2194 | 14614 | 106421 | 823832
UU,g=1]/0]1] 5 45 335 3101 29415 295 859 3031 458
UU,g=2 |} 0] 0/] 1 22 427 7557 124919 1961 246 29 479 410
UU, g=3 || 0] 0] 0 0 56 3681 139438 | 4098975 | 102054037
UU, g=4 [| 0] 0 | 0 0 0 0 17398 1768704 | 99304511
UU,g=5 || 0] 0] 0 0 0 0 0 0 11262 088

29
/n/nTable 9: Counting of bicolourable immersions of a circle of arbitrary genus g, up to stable geotopy.
U = Unoriented, O=Oriented, Oc=Oriented bicoloured, Ob=Oriented bicolourable, etc.
Figures in red should be confirmed.

n 1/2] 3 4 5 6 7 8 9 10
OOc total 2 | 6 | 20 | 108 | 776 | 7772 | 92172 | 1291048 | 20644140
OOc g =0 2/6] 18 | 74 | 364 | 2286 5106 | 109118 824612 6 502 480
OOc g=1 0} 0} 2 | 32 | 340 | 3780 | 40612 | 436368 4675012
OOc g = 2 0/0; 0 2 72 | 1630 | 31510 | 549334 8 883 620
OOc g =3 0/0] 0 0 0 76 4944 188 356 5 508 120
OOc g =4 0/0; 0 0 0 0 0 7872 752 776
OOb total 1 | 3 | 10 | 54 | 388 | 3886 | 46086 | 645524 10 322 070

OOb g=1 0/0) 1 16 | 170 | 1890 | 20306 | 218184 2337 506
OOb g = 2 0/0; 0 1 36 815 5755 | 274667 4441 810
OOb g =3 0/0; 0 0 0 38 2472 94178 2754060
OOb g =4 0/0; 0 0 0 0 0 3936 376 388
UOc total 2|)3 | 14} 54 | 420 | 3886 | 46470 | 645524 | 10328214
UOc g =0 2} 3 | 12] 37 | 198 | 1143 7658 54559 413 086 3 251 240
UOc g = 1 0} 0} 2 | 16 | 186 | 1890 | 20516 | 218184 2340 106
UOc g = 2 0/0; 0 1 36 815 5812 | 274667 4443 518
UOc g = 3 0/0] 0 0 0 38 2484 94178 2754988
UOc g =4 0/0; 0 0 0 0 0 3936 376 516
UOb, total 1/2] 7 | 30 | 210 | 1973 | 23235 | 323182 5164107

UOb, g=1 0/0) 1 8 93 945 | 10258 | 109092 1170053

UOb,g=2 || 0] 0] 0 1 18 421 7906 137585 2221759

UOb,g=3 || 0] 0] 0 0 0 19 1242 47 089 1377 494

UOb,g=4 || 0] 0] 0 0 0 0 0 2012 188 258

OUc total 1/4} 10] 60 | 388 | 3920 | 46086 | 645928 10 322070

OUc ,g=0 |} 1] 4] 9 | 42 | 182 | 1158 | 7553 54 656 412 306 3251832

OUc ,g=1],0]0] 1 16 | 170 | 1890 | 20306 | 218184 2.337 506

OUc ,g=2 || 0] 0] 0 2 36 834 | 15755 | 274922 4441810

OUc ,g=3 || 0] 0] 0 0 0 38 2472 94178 2754060

OUc ,g=4 || 0] 0] 0 0 0 0 0 3988 376 388

OUb total 1] 2} 7 | 30 | 210 | 1960 | 23276 | 322964 5 165 732
[OUb,9=0 [1] 2] 6 | at | 97 | 579 | sei2 | 27328 | 206410 | 1625916 |

OUb,g=1/,/0/0] 1 8 93 945 | 10256 | 109092 170 002

OUb ,g=2 |, 0] 0] 0 1 20 417 7948 137 461 2 222 562

OUb ,g=3 || 0] 0} 0 0 0 19 1260 47 089 378 256

OUb ,g=4 |, 0] 0] 0 0 0 0 0 1994 188 502

UUc, total 1/2} 7 | 30 | 210 | 1960 | 23235 | 322964 5164107

UUc, g = 0 1} 2] 6 | 21 | 99 579 3829 27 328 206 543 1625 916

UUc, g=1 0/07] 1 8 93 945 | 10258 | 109092 170 053

UUc, g = 2 0/0; 0 1 18 417 7906 137461 2221759

UUc, g = 3 0/0; 0 0 0 19 1242 47 089 377 494

UUc, g =4 0/0; 0 0 0 0 0 1994 188 258

UUD, total 1/2] 7 | 26 | 152 | 1168 | 12548 | 165742 2605 526

UUb, g=1 0/0) 1 6 63 539 5508 56 067 592 457
UUb, g = 2 0/0; 0 1 13 242 4183 70118 1119180
UUb, g = 3 0/0; 0 0 0 11 663 23 907 692 749
UUb,g=4 || 0|0] 0 0 0 0 0 1036 94719

30
/n/nSince our method is constructive and not only enumerative, we have not only the number of
orbits or of immersions, but also their list, encoded in the various ways explained in the previous
sections (the full listing up to n = 10 is available on request). This also enables us to draw images
of these immersions. See the UU immersions for n = 8 and n = 9 in Fig. and [16{17| respectively.
These figures have been prepared using DrawPD, a routine to draw planar diagrams, within the
Mathematica package “KnotTheory” written by Redelmeier [24] (the distinction between under-
and over-crossings is irrelevant in the current discussion).

Figure 15: The 27 indecomposable irreducible immersions of an unoriented circle in an unoriented
sphere with n = 8 double points. They may also serve as coloured and/or oriented
immersions: the first three are invariant both under swapping (colour swap or under-
crossing <> overcrossing) and mirror symmetry; the next three are swapping invariant
but have a mirror partner; the next 10 have identical swap, mirror and orientation-
reversal images ; and the last 11 give rise to four images under swapping and mirror
symmetry. In the notations of Sect. the values of Xsm,Ysm; Zsm; Usm; Wsm restricted
to this set of indecomposable irreducible immersions read (3,3,0,10,11). (For all, the
effect of orientation-reversal is the same as swapping.) We thus have 3+3+10+11=27
immersions of type UU ; 3+6+10+22= 41 of type UO; 3+3+10+22=38 of type OU;
and 3+6+20+44=73 OO or bicoloured UO immersions.

31
/n/nFigure 16: The 101 indecomposable irreducible immersions of an unoriented circle in an unoriented
sphere with n = 9 double points: on that figure, the x,,, = 14 immersions such that
o~ Om ~ Or; the Yrm = 9 ones such that o ~ oy % Om; the zm = 4 ones such that
T~ Om * Or; the Upm = 23 ones such that ¢ ~ dpm ~ o,; next figure, the wpm = 51
with no symmetry.
/n/nQPQVOBOD® ,
BQOVOOWSLS §

WSBQOSSBAE *
SOOO ©
SOODLE DOO &

BELO”

Figure 17: The 101 indecomposable irreducible immersion:

= 9 double points (cont’d): the 51 immer:

sphere with n
/n/nTo summarize what we have achieved in this paper,

e we have emphasized the role of bicolourability and made explicit 12 different types of immersions
that may be considered;

e we have extended existing series of numbers of spherical immersions to n = 10 crossings;

e we have given tables of immersions (given here for n = 8 and 9 for irreducible indecomposable
immersions, see Fig.

| but they are available on request for the other known cases);

e we have extended to non zero genus the counting of immersions and provided their cardinals up
to n = 9 or 10 crossings;

e we have discovered and proved novel relations between numbers of immersions of different types,
see Theorem

34
/n/nAppendix A : Details about the algorithms

All the tables found in the present paper, using the methods and algorithms discussed in the
different sections, have been generated using computer programs written both in Mathematica
and Magma [30]. Magma implements fast algorithms to determine explicitly the conjugates of a
chosen group element with respect to some subgroup of the permutation group, and to test whether

oO

was
a

continued until the resul
_ g2n-1

ru
inc

ac
lat
for
U,
ac

representatives for
genus 0 until the results s

determine very quickly the cen
group; this feature is used in many places in our calculations, for instance when we determine the
orbit sizes. Magma the Frobenius formula that only uses the cardinality of

he absolute or relative conjugacy classes (i.e., relative to the whole permutation group, or relative

representatives elements
aster than the available commands giving the size of double cosets.

ions to be handled becomes un:
and memory consuming

explicit construction of t
ooth in Mathematica an

We implemented in

specific subgroups); as the c
for eac!

In Sect. we work in S4n

0 go b
In Sect. for low values

ralizer of a group

1 class, is very fast

eyond n = 6 by this technique.
co)

n (up to 6) ad

1eir or
d Mag:
s to perform, using M:
ypical representative of each

s stab

€ Doorbitso lo = |y"

lependently by use of Magma

Replacing the sets Y

athema

actual

vits, together with

ma. Initially, our

i
(n — 1)!n!, where
(determination of

ion of its dihedral subgroup or of the appropria'

er stage (see Sect.
all orbits of all kinds
using Magma. A com
ions will be done

below
he or

to recover all these result:
of immersions, up to n = 9, by a direct enume
parison between the lengths of orbits obtained

, toget.
its of

1er with a particu’

had no way to check the correctness of the result k

tions of San, leading to the num!
bicolourability (the
pling) and Magma
Remember that representative e

Finally the orbits for

“Z method”

he adj

oint action of (a
oer of immersions

etermination of the size of such conjugacy classes,

o study immersions with n crossings, and the numbe
fortunately very high, even for modern processors; it

ica, a random sampling of Y’ followed
orbit of Y’, therefore giving a list of or
ize and the procedure was finally certifi

wo elements are conjugated, this allows one to determine orbit representatives. Magma can also

element in a given subgroup of a permutation

ogether with
in Magma, our algorithm turns out to be much

r of permuta-
becomes time
irect enumeration of all elements of Y’ and an
the different kinds of immersions, was possible
first method, for larger values of n, up to 9,
oy the determination of
vits. The sampling was
ed by checking the sum
orbit o was determined

the length ¢, of each

the order of stabilizers of orbits points).

y Y’) by the C, left coset U, and the adjoint action of Cy by the

e cyclic subgroup of the latter, allowed us, at a
nation of representatives

ration of all elements of

s, including the determi

for these different group
ar example. For n = 10 we could not determine

Y’ or U. We used again the same random sampling method for
abilize, but, unfortunately as we have no a priori knowledge of |Y”|, we

oy using a sum rule.
particular subgroup) S;, on the cyclic permuta-
of type OO, OU and UO, with no constraint of

of Sect. B), were obtained both using Mathematica (random sam-
full enumeration of orbits), up to n = 9 for all genera, and n = 10 in genus 0.
ements of orbits are needed in order to consider the effects of the

five types of symmetries that match Arnold’s classification. The number of orbits in Z’ = [2n]

itself (Table 4

,

aka the total number of immersions o
its variants of types UO, OU, UU, were calculated using both Magma and a Frobenius

' OO type (summing over all genera), and
ormula on

double cosets, see also our comments in Sect. The number of immersions of type OO, OU,

UO and UU were then quickly recovered by using dou
gives however slighly less information than the former (
determine the five parameters 2pm, Yrm; Zrm; Urm; Wrm Aescribing symmetries of orbit ty

More on the action of C, and D, on U. The restri
defines an action of the latter for which the set U is stab
a given orbit of Cp define an orbit of Dn, of length |Dn|/k = 2n/k, where « € U and k =

35

ble cosets and Prop. |4{ this latter method
ull enumeration of orbits) since it does not

eS.

ction of the action of C, to its subgroup Dy
e: the points of intersection between U and
C(Dn, z)|-

/n/nOn the other hand, the orbit of C, going through « has length |C,|/k’ where k’ = |C(C,, «)|.

We shall prove below that k’ = k but let us take this property for granted at the moment. As the
discussion can be carried out independently for the different genera, let us call p(k), the number
of elements of the left coset U, of fixed genus (call U, this subset), whose centralizer in D, has
order k. These ju(k) elements can be gathered into p(k)/(2n/k) orbits of Dn, but each orbit of Dn
determines one orbit of Cy, so these p(k) elements of U determine \(k) = A ulk) orbits of Cp, of
length |C,|/k. This discussion is summarized in the following proposition:

Proposition 6. For any genus g, and for all x in Ug, the following two centralizer subgroups are
equal: C(Cp,2) = C(Dn,x). Denoting by k their common order, we call u(k) = #{x € U,
|C(Dn, x)| =k}. The number of orbits of length 2n/k, for the adjoint action of Dn on Ug, is equal
to \(k) = & w(k). With the notations of the text, A(k) is also the number of orbits of length \Cp|/k,
for the adjoint action of Cy on the set Yj:

Proof. It remains to prove that C(Cp,x) = C(Dn, 2) for all x € U, hence k = k’ as stated previously.

One inclusion (C
and yx = xy; sinc
reads yBz = Bzy,
ye, nce, but

Dn,«) C C(Cy,x)) is obvious, since D, C Cy. Now take y in C(Cy, x), so y € Cy
e U = BC,, one can write x = 6 z for some z € C,, and the commutation property
equivalently y = B(zyz~1)8-!. But zyz7! € Cp soy € ch. The conclusion is that
he latter subgroup coincides with D,, (this way of defining D, was used in Sect.

. So we have also C(C,,«) C C(Dn, x), hence the equality.

ifying distincts orbits of Y’ under the adjoint action
e

Proposition [6] has a practical value: iden
of C, is a time-consuming task that is replaced by the calculation of the order of a (small) fini
with the elements of a left coset U of that group: this is much faster. The result
is illustrated on the following example : With k, the order of the centralizer C(Dn,x) of x in Uo
(the subset of the permutations of genus 0 belonging to the left coset U), and using the notation
Ke(k)=dorbits of length|Dn|/h = 5, the following sizes and numbers of D, orbits:
11640 9150 54 10? with |Up| = 1796, the number of long (open) spherical curves. The number and
orbits of Y’ under the adjoint action of the group C, is given by a similar formula with the
“exponent” multiplied by the correcting factor k/2n, so that we get, instead, 1164 930 52 102, for
a total of 198 orbits (UOc bicoloured spherical immersions). A similar analysis can be done if we
replace the dihedral subgroup D,, by its cyclic subgroup Z,,, the correcting factor being this time
equal to k/n: we have 117°5° Z,,-orbits in Up and 1°°°5° Z,,-orbits in Y’, for a total of 364 orbits
(OOc bicoloured spherical immersions).

group associated

one obtains, for n

sizes 0

Typical CPU time (T) and memory (JM) _ for calculations done on a MacBookPro 2.8 GHz
Intel Core i7, leading to the results given in Table [9] (bicolourable and/or bicoloured immersions)
are as follows: n <4: T < 0.48, M < 32MB;n=5:T =0.63s, M < 32MB;n=6:T=
4.378, M < 32MB;n=7:T = 70.645, M = 116.88 MB; n = 8: T = 3285s, M = 1316.81 MB.
For n = 9, calculations were done genus by genus on a faster machine, with a large amount of
available random access memory, but the results for each genus nevertheless required several hours
of computer time. For n = 10, the enumerative algorithm was traded for a sampling method (see
above), implemented in Mathematica, and required several weeks of CPU. With the exception of the
total number of immersions (summing over genera) of all types, obtained (up to n = 20) by a fast
algorithm using double cosets, calculations leading to Table|§| (general immersions) are significantly
slower and use more memory than the previous ones because we use the whole class of cyclic
permutation (growing like (2n — 1)! for n crossings). They could nevertheless be performed with
enumerative methods up to n = 9. Typical values are as follows: n =6:T = 12s, M < 32 MB;
n=7:T = 340s, M = 258MB; n=8: T = 6293s, M = 4934 MB; n=9: T = 1068938, M =
124.5 GB.

36
/n/nAppendix B

B.1 The five parameters wsm, Ysm, Zsm; Usm; Wsm for the C,-orbits of Y’ (or for the Dp-
orbits of U)

9 12 3 152 200
0 0 133 406 -~6
Tem; Ysm; sm; Vsm; Wsm 7 10 6 50 169 n=
(1 0 0 0 0) n=1 oo 0 3 8
(10 0 1 0) n=2 0 0 0 559 1635
0 0 0 758 4750 n=T7
0006 0 0 0 0 460 3723 —
() 001 0) n=3 0 0 0 84 579
5 0 0 12 2 39 105 29 1756 12685
000 4 2 n=4 0 0 0 3042 53025
100 0 0 47 228 104 2500 67239 n=8

0 0 0 725 23182
10 39 21 29 937

0 0 0 53 23
0 0 0 33 30 n=5
( 00 8 | 6299 100122
14861 577596
16601 1102579] n=9
8004 684745
1180 93539

ooooo
ooooo
ocoooo°o

where, for each n, successive rows correspond to increasing genus
g=0,1---,|§] (for n > 2).
For n = 10 we have only the genus 0 data :
(sm; Ysms Zsm>Usm; Wsm)g=0 = (98, 969, 247, 20681, 801837) n=10.

B.2 The five parameters %5;, Ysr, Zsr; Usr; Wsr for the Z,-orbits of U

0 0 0 33 555
Xsr, Ysry *sr> Usr, Wsr 09 0 0 0 945 n=6
0 0 0 27 394
000 0 19
(0 0 1 0 0) n=1
0 0 105 0 3724
(0 0 0 1 1) n=2 0 0 210 0 10048 n=-7
0 0 57 0 7849
0 0 12 0 1230
0 0 0 3 n=3
0010 0 ~
0 0 0 249 27155
0 0 0 0 109092
0 0 0 5 16 0 0 0 503 137082 n=8
0000 8 n=4 0 0 0 0 - 47089
0001 0 0 0 0 88 1924
0 0 16 0 83 0 0 780 0 205763
0 0 16 0 77 n=5 0 0 2600 0 1167453
00 0 0 18 0 0 1708 0 2220051] n=9
0 0 928 0 1376566
0 0 128 0 188130

37
/n/nB.3 The five parameterd!| Lsm; Ysm> Zsm; Usm; Wsm for the Z,-orbits of U

0 0 15 O 564
XLsm; Ysm, sm; Usm, Wsm 0 0 0 0 945 n=6
0 0 19 0 398
00 0 0 19
(0 0 0 1 0) n=1
0 0 0 71 3741
0 0 1 0 1 n=2 0 0 0 206 10050 _
( ) 0 0 0 141 7807 n=T
0 0 0 48 1212
0 0 0 3 3 n=3
0 0 1 0 —
0 0 97 O 27231
0 0 O 0 - 109092
0 0 5 0 16 0 0 255 0 137206 n=8
0 00 0 8 n=A4 0 0 O 0 47089
0 0 10 0 0 0 52 0 1942
0 0 0 2 85 0 0 0 514 205896
0 0 0 16 77 n=5 0 0 0 2498 1167504
9 0 0 4 16 0 0 0 3314 2219248} n=9
0 0 0 2452 1375804
0 0 0 616 187886
where, for each n>2, successive rows correspond to increasing genus g = 0,1--- , [3].

B.4 The five parameters 2pm, Yrm; Zrm; Urm; Wrm for the S,-orbits of Z’

Zrm>s Yrms %rmy Urm, Wrm

9 12 3 152 200

(1 0 0 0 0) n=1 34 82 40 472 2473
25 58 72 473 6929
10010 _ : 310:
(; 00 0 0) n=2 12 48 49 79 3493
3.0 0 3 0 35 35 18 506 1600
100 3 1 n=3 60 75 73 2169 27038
0 0 10 0 53 182 421 3272 120991
12 60 353 1397 137616
5 0 0 12 2 ;
740 na4A 0 48 116 O 17234
212 4 13
; — 39 105 29 1756 12685
10 3 1 42 20 160 1165 514 9533 284487
10 3 3) 98 221 n=5 199 1529 1571 20024 1937923
4 6 22 56 339 194 2921 2456 15177 4078227
0 0 4 0 52 36 686 1242 2092 1764648

and in genus 0,

n=9 (Crm Yrm, Zrms Urm; Wrm) = (124 328 195 5980 99794) ,

n= 10 (rms Yrms Zrms Urm; Wrm) = (98 969 247 20681 801837) .

"They should not be confused with those of Appendix B.1

38

n=6
n=7
n=8
/n/nAppendix C

The following appendix recalls how certain integrals over real, complex or matrix variables enable
one, through their Feynman diagram interpretation, to construct generating functions of maps and
in some cases, to compute the cardinals of some classes of maps.

C.1 The diagrammatic expansion of matrix integrals

Let us consider the integral over a set of f N x N Hermitian matrices Ma,a=1,--- ,f
4 f
2x [ ([] >) en NE aden (Mz) yl MaM,)?| (40)
a,b=

(initially defined for Ry < 0 and implicitly normalized by dividing by the Gaussian integral at
7 = 0). The measure DM is the natural integration measure over Hermitian matrices, DM =
uA dMii [T,< j dRM;; dSM;;. The integrand and the measure are clearly invariant under orthog-
onal transformations of the M’s, M,1> Mj = yy Oaa' Ma, O € O(f).

We are mostly interested in the series expansion in powers of y of F = log Zx , the “free energy”

foe)
F=)o7"Fn- (41)
n=1

This expansion may be obtained by diagrammatic rules, in terms of 4-valent connected maps.
As is well known since ’t Hooft [28], it is fruitful to represent Feynman diagrams arising from
the expansion of F’ with double lines, associated with the matrix indices of the M’s; for reviews,
see[13] [31] [33]. The resulting diagrams, sometimes called “fat graphs”, are in fact maps in the
combinatorial sense; moreover, here, each line across a vertex is decorated with an index a (or b)
running over f values, referred to as “flavor”. This flavor will enable us to identify the number of
components when we regard the map as a multi-component curve or an alternating link or knot

in physicists’ parlance,

diagram.
by 14@
f KR
—=—, b= fbw5i5jK < = Naa’ Spy Sit O55! kK Ou»
ai Ip

Figure 18: Feynman rules

The diagrammatic rules are the following: for a given map, to each vertex, assign a weight 5N ;
to each “component”, assign a weight f (arising from the summation over the running index a); to
each “index loop”, i.e., each face of the map, assign a weight N (arising from the summation over
matrix indices i,j = 1,--- N); and to each edge, a factor N~!. Each map then carries a power of
N equal to the Euler characteristics of the closed compact orientable Riemann surface spanned by
its faces, namely N?-29.

If F in is written as

F=SOSl NP? %9f¢ Sy Ro 42)

g>0c>1 n>1

then is by the previous rules the product of 4 (4)” times the number of labelled maps with genus g,

n vertices and c components. In other words F(9:9)(y) =>, yn BI ) is the exponential generating

39
/n/nfunction of labelled maps of given genus g and number c of components, and with n vertices. In
the present paper, we are focusing on one-component diagrams, whose generating function is

Pile — fo" N2-29 RON | (43)
n>1 g=0
In the formalism of Sect.
Ly
FOG) == (2)" #{r satisfying (I) and (II),} (44)
n>1

hence : 2
FG) Xx} ° 45
pall Oe wt 2 i “

of x! of X

with now a sum over C,-orbits o, i.e., unlabelled maps, of length @,. Thus do = vas = Cel , the

“symmetry factor” in Feynman rules, is the order of the stabilizer group of the orbit o. ae an
independent argument shows, (see for example Sect. c), d, turns out to be a divisor of 2n.
For genus g = 0 (planar maps), the first terms of the series expansion (43) read

1 4
99 8407

1 1
([pllc] ,_ n 7A(0,1) _ 9, 4
yak => PFO) = 324 + G82? + wai

1344y° 4
a
(46)

1 5
+ Gop} 034.624y? +.

and more terms appear in Tables [I] and [2]
Unfortunately, there exists no closed formula for this series, in contrast with the cases f = 1
for which we have Tutte’s result ([32], see also [34] or equ. (3.9) of [35]).

i n (0,c) _ — yn (2n— 1)!
jim, oF = vy > FO) — y( 3y) nin + 2)I (47)

n21 cal n=1

or with the sum over all genera of one-component maps (i.e., the case N = 1 of (43))

pit

Nel f > G yt (n= on see below equ. (53) ) (48)

Two other matrix integrals. The reader will convince him/her-self that the case of bicolourable
curves or of alternating knots and links is related in the same way to another matrix integral,

f f Of
Zy = JU D(Ma, M})) exp —N[_ tr (M,M}) — t > tr (MaM})?] (49)
a=1 a=1 a,b=1
with now an integration over complex N x N matrices. From the fact that any planar map may
be bicoloured in two different ways, it follows that the free energy log Zy coincides up to a factor
2 with F = log Zx considered above. Thus, using the formalism of Sect.

POD = a € Son |p € [2"](") 1 (I)o} (50)
= (2n- 1s anit? € Son | (IU) 9 (II’)o with p = po, T= ap}, (51)

40
/n/nwhere in the first line the factor 2(2n)! comes from the two possible bicolourations along with a
general relabelling of the 2n edges, and in the second, the factor (2n — 1)!! comes from the possible
choices of p, (pairings at vertices). The bottom line of table Bs that ROY) = simile ve}.
(Fortunately the results coincide with those of Table [I] !)

Finally the counting of general oriented curves in Sect. p]is related to the following integral
f f ¥ f ;
= i i _ yi) — t
Zz = / (1 20%.) exp aps tr(MaM}) ~ 7 ye r(MaM,Mimf)). (52)

For one-component maps, there are two ways of orienting the corresponding curve, hence the free

: coincides up to a factor 2 with F considered above, for any genus.
term f

energy rid = log Zz

C.2 The cardinal of X’ through a simple integral

In this section we compute the cardinal of the set X’ of Sect. [3] through a simple integral. Recall
that X’ gathers maps of all genera. Since we are not concerned by the genus of the graph/map, we
may use an integration over real vectors ¢ of R/‘ rather than matrices, i.e., the case N = 1 of the

integral . Let

Z= (any! f ao expl-30? + 1?) (53)

in which the terms linear in f yield the contribution of one-component graphs. As above, we assume
that Ry < 0 and we have explicitly normalized Z to be 1 for y = 0. Following a standard trick, we
rewrite Z as

da i) df 1. .
z= | Oe ° ey Oni exp| ane + 2ir/—7a)] . (54)
Integrating over the f-dimensional ¢ gives
di ;
Z ew (1 + 2i/—Fa) 47? , (55)

RVO

In the series expansion of the term (1 + Qin/—Ja)f /2 we keep only the term of order f!, hence

= fy Bae") 60)

| f term

n>1
where (a) denote the moments of the Gaussian measure tee. Only even moments are non
vanishing and we find
a =F 2" on — 1) (57)
f term n=l 4n

which may be recast as
z| = Peel = (2)"( (4n — 2)!!. 58
f term por n! ” ys ( )

By comparing this calculation with formula one sees that the coefficient (4n — 2)!! is nothing
else than the number of points in the set " " Be also next Appendix for a direct combinatorial
argument.

41
/n/nC.3 The set X’ c [2?"]

In this section, we reproduce the previous result on |X’| by a purely combinatorial argument. The
set X’ of permutations 7 € [2?”] that satisfy o?7 € [(2n)?] may be constructed explicitly. We
choose o = (1324) -+- (4n — 3,4n — 1,4n — 2,4n) so that o? = (12)(34)---(4n — 1,4n). We note
that i; := (1) is different from 1 (since 7 € [2?"]), and from 2 = o?(1), otherwise o? 7 would have
a l-cycle. We thus have 4n — 2 possible choices for 71.

By recursion, suppose that after r < 2n iterations, we choose i, := T(o(ir—1)) different from
to = Qt, ee: tipi = t(o? (ip_2)) and from their images by o?, with these 2r numbers assumed to
be all different: we thus have 4n — 2r choices for 7,.

Then for any 0 < s < r—1, 0°(i-) 4 o7(is) since i, # is; and o7(i-) 4 is & ip F O7(is) by
assumption.

Moreover ipy1 := TO?(ir) = (7 07)"t!(2) must be different from the 2(r +1) numbers ig :=
2,i1,--+ ,i, and their images by o?:
1. forO<s<r-1, ips, = 707 (ip) F 07 (ig) o*(ip) £ TO7(is) = is41 ip # 07 (ig41) by

the assumption on i, for s < r—1, and the fact that 0? has no fixed point for s =r —1;
2. ing, = 707 (i>) £ 07 (ip) since T has no fixed point;
3. for 1 <s <r, ip, =TO7(ip) Ais = T(o7(is_1)) since i, A ig_1;
4. finally, ip, = 7 0?(ip) = (7 0?)"*+(2) may be equal to ig = 2 iff 2 is a fixed point of (7 0?)"*1,
which occurs iff r + 1 = 2n (remember that 7 0? € [(2n)?]).

Hence, for r < 2n—1, the recursion assumption is verified, and there are 4n—2(r+1) choices for ip41.

At the end of this iterateve procedure we have constructed a7 = ((1,i1), (0? (i1), 72), -** , (0? (ian—1), t2n);
and all 7 € X’ are obtained that way. This completes the construction of the set X’ and the proof
that [X’| = []257(4n — 2(r + 1)) = (4n — 2)!

C.4 The set Y’ C So,

By lack of a direct combinatorial construction of the set Y’ (as we had for X’, see previous ap-
pendix), we resort again to a simple integral to compute the cardinality of Y’.. In the same spirit
as in App.C.2, let us consider the integral over vectors of Cf

1
ont

Z d!(z,Z)exp[—z- 2+ qe (59)

where z-Z = ye Zaza, 22 = yl (za)? and likewise for 72. Note that this may be regarded as

the N = 1 version of integral (49). We take 7 < 0 to ensure convergence. Using again the same
trick, we rewrite Z, up to a factor, as

a - F(x A /
Z= / don a) eo [° (2,2) exp[—z-Z i [2 2a-i 72a] (60)
T af 4 4

which upon integration over z,Z gives

Moa. a _
Z= / AMA) (0.8) (aac - yaa) f/? (61)

Keeping again the term of order f! in the expansion of (1 — yaa)-f /2 gives

_ ‘> ((eay") (62)

n>1

Z|

f term

42
/n/nd(a,@)

where ((aa@)") = n! are the moments of the measure e~°*, hence

= i> 1 (2)"2"-In(n —1)! (63)

nt
yu

2|
f term —
which (in view of the diagrammatic interpretation 4 la Feynman of this computation) shows that
the number of points in the set Y’ is indeed 2?”~!n!(n — 1)! = (2n)!!(2n — 2)!!.

As a little exercise left to the reader, one may check that the same reasoning applied to integral
(52), i.e., consideration of the integral

a)

Z= fica exp[-z- 2+ 4@ -2)7] (64)

and computation of its f! term will reproduce the counting of points in the set Z’ of Sect.
namely (2n — 1)!.

Acknowledgements

We acknowledge useful discussions with Alina Vdovina and Paul Zinn-Justin and a very stimulating
correspondence with Guy Valette. Partial support from the EPLANET network and from IMPA
(Rio de Janeiro) is also acknowledged.

References

[1] L. Kauffman, Virtual knot theory, Europ. J. Combin. 20 (1999) 663-690, |nttp: //arxiv.org/

[2] V.I. Arnold, Topological invariants of plane curves and caustics, University Lecture Series vol
5, Amer. Math. Soc., 1991.

[3] V.I. Arnold, Remarks on the enumeration of plane curves, in Kharlamov, V. (ed.) et al.,
Topology of real algebraic varieties and related topics, dedicated to the memory of D. A. Gud-
kov. Transl. ed. by A. B. Sossinsky. Providence, RI: American Mathematical Society. Transl.,
Ser. 2, Amer. Math. Soc. 173 (1996) 17-32.

4| OEIS web site http: //oeis.org/book. html, A008986, A008987, A008988, A008989.

J.S. Carter, Classifying immersed curves, Proc. Amer. Math. Soc. 111 (1991) 281-287.

ou

6] M. Bourgoin, Cohomology and immersed curves, Topology and its Applications [7], 10, (2008),
http://arxiv.org/abs/0807 .1311

7| S. Chmutov and S. Duzhin, Explicit formulas for Arnold’s generic curves invariants, in: Arnold-
Gelfand Mathematical Seminars: Geometry and Singularity Theory, Birkhauser, 1997, p. 123
138.

8] G.Cairns and D.M. Elton, The planarity problem for signed Gauss word, Journal of Knot
Theory and its Ramifications, 2 (1993) 359-367.

9| D. Buck, E. Dolzhenko, N. Jonoska, M. Saito and K. Valencia, Genus ranges of 4-regular rigid

vertex graphs, |nttp://arxiv.org/abs/1211.4939

[10] R. Arredondo, Properties of Graphs Used to Model DNA Recombination, Master of Arts thesis

(2014), http: //scholarcommons.usf.edu/etd/4979/

43

/n/not

17

18

19

20

21

22

23

24

26

G. Valette, A classification of spherical curves based on Gauss diagrams, preprint June 2015,
to appear in Arnold Mathematical Journal, and private communication.

T.R.S. Walsh and A.B. Lehman, Counting Rooted maps by Genus, Journ. of Combinatorial
Theory B13 (1972) 192-218.

D. Bessis, C. Itzykson and J.-B. Zuber, Quantum field theory techniques in graphical enumer-
ation, Adv. Appl. Math. 1 (1980) 109-157.

F. G. Frobenius, Uber die Congruenz nach einem aus zwei endlichen Gruppen gebildeten
Doppelmodul, Journ. f. die reine und angewandte Mathematik 101 (1887) 273-299, reprinted
in Gesammelte Abhandlungen, vol. 2, p 304-330, J.-P. Serre edr, Springer 1968.

L.B. Richmond and N.C. Wormald, Almost all maps are asymmetric, J. Combin. Th. Ser. B
63 (1995) 1-7.

P. Zinn-Justin and J.-B. Zuber, Matrix Integrals and the Generation and Counting of Virtual
Tangles and Links, JKTR 13 (2004) 325-355; Knot theory and matrix integrals, in The Oxford
Handbook of Random Matrix Theory, G. Akemann, J. Baik and P. Di Francesco eds, Oxford
Univ. Press 2011.

T. Ceccherini-Silberstein, F. Scarabotti, and F. Tolli, Finite Gelfand pairs and their appli-
cations to probability and statistics, Journal of Mathematical Sciences, 141 , No. 2 (2007)
1182-1229.

K.Aker and M.B. Can, Generators of the Hecke algebra of (San, Bn), Advances in Mathematics
231, (5) (2012) 2465-2483; http: //arxiv.org/abs/1009.5373v2

LG. Macdonald, Symmetric functions and Hall polynomials. Oxford Univ. Press, second edi-
tion, 1995.

S.M. Gusein-Zade and F.S. Duzhin, On the number of topological types of plane curves,
Uspekhi Math. Nauk. (1998) 53 197-198; (English translation in) Russian Math. Surveys 53
(1998) 626-627.

J. Jacobsen and P. Zinn-Justin, A transfer matrix approach to the enumeration of knots,
Journal of Knot Theory and its Ramifications, 10 (2001) 1233-1267.

G. Schaeffer and P. Zinn-Justin, On the asymptotic number of plane curves and alternating
knots, Experiment. Math. 13 (4) (2004) 483 493; http: //arxiv.org/abs/math-ph/0304034

T.P. Kirkman, The enumeration, description and construction of knots of fewer than ten cross-
ings, Trans. Roy. Soc. Edinburgh 32 (1885), 281-309; The 364 unifilar knots of ten crossings,
enumerated and described, Ibid., 32 (1885) 483491.

E. Redelmeier, KnotTheory, a Mathematica package available on http: //katlas.org/wiki/
KnotTheory

P. Di Francesco, O. Golinelli and E. Guitter, Meanders: exact asymptotics, Nucl.Phys. B570
(2000) 699-712; http: //arxiv.org/abs/cond-mat/9910453

W.W. Menasco and M.B. Thistlethwaite, The Tait Flyping Conjecture, Bull. Amer. Math.
Soc. 25 (1991) 403-412; The Classification of Alternating Links, Ann. Math. 138 (1993) 113
171.

C. Sundberg and M. Thistlethwaite, The rate of Growth of the Number of Prime Alternating
Links and Tangles, Pac. J. Math. 182 (1998) 329-358.

44
/n/nP. Zinn-Justin’s web site, http://www. 1lpthe.jussieu.fr/~pzinn/virtlinks/

G. ’t Hooft, A Planar Diagram Theory for Strong Interactions, Nucl. Phys. B 72 (1974)
461-473.

Mathematica, Version 10.1, Wolfram Research, http: / /waw.wolfram . com)

W. Bosma, J. Cannon, and C. Playoust, The Magma algebra system. I. The user language, J.
Symbolic Comput., 24 (1997), 235!http://magma.maths.usyd.edu.au

A. Zvonkin, Matrix integrals and map enumeration: an accessible introduction, Math. Comp.
Modelling 26 (1997) 281-304.

W.T. Tutte, A census of planar maps, Can. J. Math. 15 (1963) 249-271.

J. Bouttier, Enumeration of Maps, in the Oxford Handbook of Random Matrix Theory, G.

Akemann, J. Baik and P. Di Francesco edrs, Oxford University Press 2011; http://arxiv.
org/abs/1104.3003

E. Brézin, C. Itzykson, G. Parisi and J.-B. Zuber, Planar diagrams, Comm. Math. Phys. 59
(1978) 35-51.

P. Zinn-Justin and J.-B. Zuber, Matrix integrals and the counting of tangles and links, Discrete
Mathematics 246 (2002) 343-360.

J. Bétréma, private communication and to appear.

45
